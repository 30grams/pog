{"version":3,"sources":["webpack:///./src/css/style.css","webpack:///./src/css/style.css?2fd6","webpack:///./src/js/app.js","webpack:///./src/js/data-seed.js","webpack:///./src/js/draw-map.js","webpack:///./src/js/draw-textures.js","webpack:///./src/js/game.js","webpack:///./src/js/scripts/TrackballControls.js","webpack:///./src/js/scripts/stats.min.js","webpack:///./src/js/vendor/simplex-noise.js"],"names":["module","exports","__webpack_require__","push","i","./src/css/style.css","e","t","n","content","hmr","transform","insertInto","locals","o","r","__esModule","default","container","document","createElement","id","body","appendChild","window","onload","_game2","generateMap","seed","Math","random","toString","simplex","_simplexNoise2","hashCode","Array","mapWidth","fill","map","el","mapHeight","j","x","y","noise2D","String","prototype","len","hash","this","length","charCodeAt","scene","tileGeometry","_three","CylinderGeometry","tileRadius","tileDepth","MeshLambertMaterial","color","flatShading","computeFlatVertexNormals","tileMap","_dataSeed","round","tile","Mesh","_drawTextures","flatMaterial","position","tileWidth","z","tileHeight","floor","castShadow","receiveShadow","add","sqrt","GREEN","./src/js/game.js","Object","defineProperty","value","init","animate","THREE","a","camera","controls","renderer","stats","mouse","INTERSECTED","PerspectiveCamera","innerWidth","innerHeight","set","Scene","background","Color","_drawMap2","groundGeo","PlaneBufferGeometry","groundMat","MeshPhongMaterial","specular","setHSL","ground","rotation","PI","hemiLight","HemisphereLight","groundColor","hemiLightHelper","HemisphereLightHelper","dirLight","DirectionalLight","multiplyScalar","shadow","mapSize","width","height","left","right","top","bottom","far","dirLightHelper","DirectionalLightHelper","WebGLRenderer","setPixelRatio","devicePixelRatio","setSize","shadowMap","enabled","type","PCFSoftShadowMap","getElementById","domElement","_statsMin2","dom","TrackballControls","rotateSpeed","zoomSpeed","panSpeed","noZoom","noPan","staticMoving","dynamicDampingFactor","keys","addEventListener","render","onWindowResize","onDocumentMouseMove","aspect","updateProjectionMatrix","handleResize","requestAnimationFrame","vector","Vector3","unproject","intersects","Raycaster","sub","normalize","intersectObjects","children","object","material","setHex","currentHex","getHex","update","event","clientX","clientY","three__WEBPACK_IMPORTED_MODULE_0__","_this","STATE","NONE","ROTATE","ZOOM","PAN","TOUCH_ROTATE","TOUCH_ZOOM_PAN","screen","noRotate","minDistance","maxDistance","Infinity","target","lastPosition","_state","_prevState","_eye","_movePrev","Vector2","_moveCurr","_lastAxis","_lastAngle","_zoomStart","_zoomEnd","_touchZoomDistanceStart","_touchZoomDistanceEnd","_panStart","_panEnd","target0","clone","position0","up0","up","changeEvent","startEvent","endEvent","box","getBoundingClientRect","d","ownerDocument","documentElement","pageXOffset","clientLeft","pageYOffset","clientTop","handleEvent","angle","axis","quaternion","eyeDirection","objectUpDirection","objectSidewaysDirection","moveDirection","mouseChange","objectUp","pan","getMouseOnScreen","pageX","pageY","getMouseOnCircle","keydown","removeEventListener","keyCode","keyup","mousedown","preventDefault","stopPropagation","button","copy","mousemove","mouseup","dispatchEvent","mousewheel","deltaMode","deltaY","touchstart","touches","dx","dy","touchmove","touchend","contextmenu","rotateCamera","Quaternion","crossVectors","setLength","setFromAxisAngle","applyQuaternion","zoomCamera","factor","panCamera","lengthSq","cross","subVectors","checkDistances","addVectors","lookAt","distanceToSquared","reset","dispose","create","EventDispatcher","constructor","assign","Stats","h","c","k","style","display","l","cssText","g","performance","Date","now","Panel","f","self","memory","REVISION","addPanel","showPanel","begin","end","usedJSHeapSize","jsHeapSizeLimit","setMode","u","m","p","q","b","getContext","font","textBaseline","fillStyle","fillRect","fillText","globalAlpha","v","min","max","drawImage","F2","G2","G3","F4","G4","SimplexNoise","randomOrSeed","s0","s1","s2","mash","data","arguments","buildPermutationTable","perm","Uint8Array","permMod12","aux","grad3","Float32Array","grad4","xin","yin","i1","j1","n0","n1","n2","s","x0","y0","x1","y1","x2","y2","ii","jj","t0","gi0","t1","gi1","t2","gi2","noise3D","zin","n3","k1","i2","j2","k2","z0","z1","z2","x3","y3","z3","kk","t3","gi3","noise4D","w","n4","l1","l2","i3","j3","k3","l3","w0","rankx","ranky","rankz","rankw","w1","w2","w3","x4","y4","z4","w4","ll","t4","gi4","_buildPermutationTable","__WEBPACK_AMD_DEFINE_RESULT__","call"],"mappings":"mIAAAA,EAAAC,QAAAC,EAAA,4CAAAA,MAKAC,MAAAH,EAAAI,EAAA,8hBAA6iB,MAAAC,sBAAA,SAAAC,EAAAC,EAAAC,GCJ7iB,IAAAC,EAAAP,EAAA,0DAEA,iBAAAO,QAAAT,EAAAI,EAAAK,EAAA,MAYAP,EAAA,+CAAAA,CAAAO,GALeC,OAEfC,iBACAC,oBAIAH,EAAAI,SAAAb,EAAAC,QAAAQ,EAAAI,wDCjBAX,EAAA,uBACA,IAAAY,EAAAC,GAAAD,EAAAZ,EAAA,sBAAAY,EAAAE,WAAAF,GAAAG,QAAAH,GAMII,EAAYC,SAASC,cAAc,OACvCF,EAAUG,GAAK,YAEfF,SAASG,KAAKC,YAAYL,GAC1BM,OAAOC,UAASC,EAAAT,oHCUAU,YAAT,SAAqBC,GACrBA,IACHA,EAAOC,KAAKC,OAAOC,YAGrB,IAAMC,EAAU,IAAAC,EAAAhB,QAAiBW,EAAKM,YAetC,OAPmB,IAAIC,MAAMC,GAAUC,KAAK,MAAMC,IAAI,SAACC,EAAInC,GACzD,OAAO,IAAI+B,MAAMK,GAAWH,KAAK,MAAMC,IAAI,SAACC,EAAIE,GAE9C,OAPmBC,EAOItC,EAPFuC,EAOKF,EANrBT,EAAQY,QAAQF,EAAEC,GADL,IAACD,EAAEC,OA9B3B,IAAA7B,EAAAC,GAAAD,EAAAZ,EAAA,sCAAAY,EAAAE,WAAAF,GAAAG,QAAAH,GAIMsB,EAAW,GACfI,EAAY,GAGdK,OAAOC,UAAUZ,SAAW,WAE1B,IAAc9B,EAAQ2C,EAAlBC,EAAO,EACX,GAAmB,GAAfC,KAAKC,OAAa,OAAOF,EAC7B,IAAK5C,EAAI,EAAG2C,EAAME,KAAKC,OAAQ9C,EAAI2C,EAAK3C,IAEtC4C,GAAUA,GAAQ,GAAKA,EADfC,KAAKE,WAAW/C,GAExB4C,GAAQ,EAEV,OAAOA,mHCNM,SAAkBI,GAG/B,IAAIC,EAAe,IAAAC,EAAAC,iBAAsBC,EAAYA,EAAYC,EAAW,EAAG,GAChE,IAAAH,EAAAI,qBAA2BC,MAAO,QAAUC,iBAE3DP,EAAaQ,2BAsBb,IAnBA,IAAIC,KAAUC,EAAApC,aAAY,QAmBhBvB,GAAKyB,KAAKmC,MAAMF,EAAQZ,OAAS,GAAI9C,EAAI0D,EAAQZ,OAASrB,KAAKmC,MAAMF,EAAQZ,OAAS,GAAI9C,IAClG,IAAM,IAAIqC,GAAKZ,KAAKmC,MAAMF,EAAQ,GAAGZ,OAAS,GAAIT,EAAIqB,EAAQ,GAAGZ,OAASrB,KAAKmC,MAAMF,EAAQ,GAAGZ,OAAS,GAAIT,IAAM,CAGjH,IAAIwB,EAAO,IAAAX,EAAAY,KAAUb,KAAcc,EAAAC,iBACnCH,EAAKI,SAAS3B,EAAI4B,GAAclE,EAAIqC,EAAI,GACxCwB,EAAKI,SAASE,EAAiB,EAAbC,EAAe,EAAI/B,EACrCwB,EAAKI,SAAS1B,EAAuC,IAAhCd,KAAK4C,MAAsB,EAAhB5C,KAAKC,UAAuB2B,EAAU,EAEtEQ,EAAKS,cACLT,EAAKU,iBACLvB,EAAMwB,IAAKX,KAlDjB,IAAAX,EAAApD,EAAA,8CACA6D,EAAA7D,EAAA,yBACAiE,EAAAjE,EAAA,6BAEMsD,EAAa,EAClBC,EAAY,EAGPe,EAA0B,EAAbhB,EACbc,EAAYzC,KAAKgD,KAAK,GAAG,EAAIL,+GCWnBJ,aAAT,WACL,OAAO,IAAAd,EAAAI,qBAA2BC,MAAOmB,EAAOlB,kBArBlD,IAAAN,EAAApD,EAAA,8CAIM4E,EAAQ,SAAAC,mBAAA,SAAAzE,EAAAC,EAAAC,GAAA,aAAAwE,OAAAC,eAAA1E,EAAA,cAAA2E,OAAA,IAAA3E,EAAAU,QCSC,WAGbkE,IAGAC,OAIcD,OAvBhB,IAAYE,0JAAZnF,EAAA,+CAAAoF,EAAAlF,EACAF,EAAA,kCAAAa,EAAAX,EACAF,EAAA,kCAAAE,EAAAE,GAAA,OAAAA,KAAAU,WAAAV,GAAAW,QAAAX,GACAJ,EAAA,yCAEA,IAAIqF,SAAQC,SAAUpC,SAAOqC,SAAUC,SACxBC,GACXjD,EAAG,EACHC,EAAG,GAELiD,SAaK,SAAST,KAEdI,EAAS,IAAIF,EAAMQ,kBAAmB,GAAIrE,OAAOsE,WAAatE,OAAOuE,YAAa,EAAG,MAC9E1B,SAAS2B,IAAK,EAAG,GAAI,IAG5B5C,EAAQ,IAAIiC,EAAMY,OACZC,WAAa,IAAIb,EAAMc,MAAO,MAGpCC,EAAAnF,SAASmC,GAET,IAAIiD,EAAY,IAAIhB,EAAMiB,oBAAqB,IAAO,KAClDC,EAAY,IAAIlB,EAAMmB,mBAAqB7C,MAAO,SAAU8C,SAAU,SAC1EF,EAAU5C,MAAM+C,OAAQ,KAAO,EAAG,KAElC,IAAIC,EAAS,IAAItB,EAAMnB,KAAMmC,EAAWE,GACxCI,EAAOC,SAASlE,GAAKb,KAAKgF,GAAG,EAC7BF,EAAOtC,SAAS1B,GAAK,EACrBgE,EAAOhC,iBAEPvB,EAAMwB,IAAK+B,GAGX,IAAIG,EAAY,IAAIzB,EAAM0B,gBAAiB,SAAU,SAAU,IAC/DD,EAAUnD,MAAM+C,OAAQ,GAAK,EAAG,IAChCI,EAAUE,YAAYN,OAAQ,KAAO,EAAG,KACxCI,EAAUzC,SAAS2B,IAAK,EAAG,GAAI,GAE/B5C,EAAMwB,IAAKkC,GAEX,IAAIG,EAAkB,IAAI5B,EAAM6B,sBAAuBJ,EAAW,IAElE1D,EAAMwB,IAAKqC,GAGX,IAAIE,EAAW,IAAI9B,EAAM+B,iBAAkB,SAAU,GACrDD,EAASxD,MAAM+C,OAAQ,GAAK,EAAG,KAC/BS,EAAS9C,SAAS2B,KAAM,EAAG,KAAM,GACjCmB,EAAS9C,SAASgD,eAAgB,IAElCF,EAASzC,cACTyC,EAASG,OAAOC,QAAQC,MAAQ,KAChCL,EAASG,OAAOC,QAAQE,OAAS,KAEjCrE,EAAMwB,IAAKuC,GAGXA,EAASG,OAAO/B,OAAOmC,MADf,GAERP,EAASG,OAAO/B,OAAOoC,MAFf,GAGRR,EAASG,OAAO/B,OAAOqC,IAHf,GAIRT,EAASG,OAAO/B,OAAOsC,QAJf,GAMRV,EAASG,OAAO/B,OAAOuC,IAAM,KAG7B,IAAIC,EAAiB,IAAI1C,EAAM2C,uBAAwBb,EAAU,IAEjE/D,EAAMwB,IAAKmD,IAGXtC,EAAW,IAAIJ,EAAM4C,eACZC,cAAe1G,OAAO2G,kBAC/B1C,EAAS2C,QAAS5G,OAAOsE,WAAYtE,OAAOuE,aAG5CN,EAAS4C,UAAUC,WACnB7C,EAAS4C,UAAUE,KAAOlD,EAAMmD,iBAGhC,IAAItH,EAAYC,SAASsH,eAAgB,aACzCvH,EAAUK,YAAakE,EAASiD,YAGhChD,EAAQ,IAAAiD,EAAA1H,QACRC,EAAUK,YAAamE,EAAMkD,MAG7BpD,EAAW,IAAIH,EAAMwD,kBAAmBtD,IAE/BuD,YAAc,EACvBtD,EAASuD,UAAY,IACrBvD,EAASwD,SAAW,GAEpBxD,EAASyD,UACTzD,EAAS0D,SAET1D,EAAS2D,gBACT3D,EAAS4D,qBAAuB,GAEhC5D,EAAS6D,MAAS,GAAI,GAAI,IAE1B7D,EAAS8D,iBAAkB,SAAUC,GAGrC/H,OAAO8H,iBAAkB,SAAUE,MAGnCrI,SAASmI,iBAAiB,YAAaG,MAGvCF,IAGF,SAASC,IACPjE,EAAOmE,OAASlI,OAAOsE,WAAatE,OAAOuE,YAC3CR,EAAOoE,yBACPlE,EAAS2C,QAAS5G,OAAOsE,WAAYtE,OAAOuE,aAC5CP,EAASoE,eACTL,IAGF,SAASnE,IAEPyE,sBAAuBzE,GACvBmE,IAcF,WAGE,IAAIO,EAAS,IAAIzE,EAAM0E,QAAQpE,EAAMjD,EAAGiD,EAAMhD,EAAG,GACjDmH,EAAOE,UAAUzE,GACjB,IAKI0E,EALM,IAAI5E,EAAM6E,UAAU3E,EAAOlB,SAAUyF,EAAOK,IAAI5E,EAAOlB,UAAU+F,aAKtDC,iBAAiBjH,EAAMkH,UAMxCL,EAAW/G,OAAS,EAElB+G,EAAW,GAAGM,QAAU3E,IAEtBA,GACFA,EAAY4E,SAAS7G,MAAM8G,OAAO7E,EAAY8E,aAEhD9E,EAAcqE,EAAW,GAAGM,QAEhBG,WAAa9E,EAAY4E,SAAS7G,MAAMgH,SAEpD/E,EAAY4E,SAAS7G,MAAM8G,OAAO,YAKhC7E,GACFA,EAAY4E,SAAS7G,MAAM8G,OAAO7E,EAAY8E,YAGhD9E,EAAc,MAGhBJ,EAASoF,SACTlF,EAAMkF,SAxCR,GAVA,SAASnB,EAAoBoB,GAM3BlF,EAAMjD,EAAKmI,EAAMC,QAAUtJ,OAAOsE,WAAc,EAAI,EACpDH,EAAMhD,GAAMkI,EAAME,QAAUvJ,OAAOuE,YAAe,EAAI,EA8CxD,SAASwD,IACP9D,EAAS8D,OAAQnG,EAAOmC,iFCpM1B,IAAAyF,EAAA9K,EAAA,8CAWA,IAAA2I,EAAA,SAAA0B,EAAA7B,GAEA,IAAAuC,EAAAhI,KACAiI,GAAcC,MAAA,EAAAC,OAAA,EAAAC,KAAA,EAAAC,IAAA,EAAAC,aAAA,EAAAC,eAAA,GAEdvI,KAAAsH,SACAtH,KAAAyF,wBAAAvH,SAIA8B,KAAAqF,WAEArF,KAAAwI,QAAgB/D,KAAA,EAAAE,IAAA,EAAAJ,MAAA,EAAAC,OAAA,GAEhBxE,KAAA6F,YAAA,EACA7F,KAAA8F,UAAA,IACA9F,KAAA+F,SAAA,GAEA/F,KAAAyI,YACAzI,KAAAgG,UACAhG,KAAAiG,SAEAjG,KAAAkG,gBACAlG,KAAAmG,qBAAA,GAEAnG,KAAA0I,YAAA,EACA1I,KAAA2I,YAAAC,IAEA5I,KAAAoG,MAAA,UAIApG,KAAA6I,OAAA,IAAAd,EAAAjB,QAEA,IAEAgC,EAAA,IAAAf,EAAAjB,QAEAiC,EAAAd,EAAAC,KACAc,EAAAf,EAAAC,KAEAe,EAAA,IAAAlB,EAAAjB,QAEAoC,EAAA,IAAAnB,EAAAoB,QACAC,EAAA,IAAArB,EAAAoB,QAEAE,EAAA,IAAAtB,EAAAjB,QACAwC,EAAA,EAEAC,EAAA,IAAAxB,EAAAoB,QACAK,EAAA,IAAAzB,EAAAoB,QAEAM,EAAA,EACAC,EAAA,EAEAC,EAAA,IAAA5B,EAAAoB,QACAS,EAAA,IAAA7B,EAAAoB,QAIAnJ,KAAA6J,QAAA7J,KAAA6I,OAAAiB,QACA9J,KAAA+J,UAAA/J,KAAAsH,OAAAlG,SAAA0I,QACA9J,KAAAgK,IAAAhK,KAAAsH,OAAA2C,GAAAH,QAIA,IAAAI,GAAoB5E,KAAA,UACpB6E,GAAmB7E,KAAA,SACnB8E,GAAiB9E,KAAA,OAKjBtF,KAAA2G,aAAA,WAEA,GAAA3G,KAAAyF,aAAAvH,SAEA8B,KAAAwI,OAAA/D,KAAA,EACAzE,KAAAwI,OAAA7D,IAAA,EACA3E,KAAAwI,OAAAjE,MAAAhG,OAAAsE,WACA7C,KAAAwI,OAAAhE,OAAAjG,OAAAuE,gBAEG,CAEH,IAAAuH,EAAArK,KAAAyF,WAAA6E,wBAEAC,EAAAvK,KAAAyF,WAAA+E,cAAAC,gBACAzK,KAAAwI,OAAA/D,KAAA4F,EAAA5F,KAAAlG,OAAAmM,YAAAH,EAAAI,WACA3K,KAAAwI,OAAA7D,IAAA0F,EAAA1F,IAAApG,OAAAqM,YAAAL,EAAAM,UACA7K,KAAAwI,OAAAjE,MAAA8F,EAAA9F,MACAvE,KAAAwI,OAAAhE,OAAA6F,EAAA7F,SAMAxE,KAAA8K,YAAA,SAAAlD,GAEA,mBAAA5H,KAAA4H,EAAAtC,OAEAtF,KAAA4H,EAAAtC,MAAAsC,IAMA,IAEAf,EAwCAkE,EANAC,EACAC,EACAC,EACAC,EACAC,EACAC,EAqFAC,EACAC,EACAC,EAhIAC,GAEA5E,EAAA,IAAAkB,EAAAoB,QAEA,SAAAuC,EAAAC,GAOA,OALA9E,EAAA9D,KACA2I,EAAA1D,EAAAQ,OAAA/D,MAAAuD,EAAAQ,OAAAjE,OACAoH,EAAA3D,EAAAQ,OAAA7D,KAAAqD,EAAAQ,OAAAhE,QAGAqC,IAMA+E,EAAA,WAEA,IAAA/E,EAAA,IAAAkB,EAAAoB,QAEA,gBAAAuC,EAAAC,GAOA,OALA9E,EAAA9D,KACA2I,EAAA,GAAA1D,EAAAQ,OAAAjE,MAAAyD,EAAAQ,OAAA/D,OAAA,GAAAuD,EAAAQ,OAAAjE,QACAyD,EAAAQ,OAAAhE,OAAA,GAAAwD,EAAAQ,OAAA7D,IAAAgH,IAAA3D,EAAAQ,OAAAjE,OAGAsC,GAXA,GAgOA,SAAAgF,EAAAjE,QAEAI,EAAA3C,UAEA9G,OAAAuN,oBAAA,UAAAD,GAEA7C,EAAAD,EAEAA,IAAAd,EAAAC,OAIGN,EAAAmE,UAAA/D,EAAA5B,KAAA6B,EAAAE,SAAAH,EAAAS,SAIAb,EAAAmE,UAAA/D,EAAA5B,KAAA6B,EAAAG,OAAAJ,EAAAhC,OAIA4B,EAAAmE,UAAA/D,EAAA5B,KAAA6B,EAAAI,MAAAL,EAAA/B,QAEH8C,EAAAd,EAAAI,KAJAU,EAAAd,EAAAG,KAJAW,EAAAd,EAAAE,SAcA,SAAA6D,EAAApE,QAEAI,EAAA3C,UAEA0D,EAAAC,EAEAzK,OAAA8H,iBAAA,UAAAwF,OAIA,SAAAI,EAAArE,QAEAI,EAAA3C,UAEAuC,EAAAsE,iBACAtE,EAAAuE,kBAEApD,IAAAd,EAAAC,OAEAa,EAAAnB,EAAAwE,QAIArD,IAAAd,EAAAE,QAAAH,EAAAS,SAKGM,IAAAd,EAAAG,MAAAJ,EAAAhC,OAKA+C,IAAAd,EAAAI,KAAAL,EAAA/B,QAEH0D,EAAA0C,KAAAZ,EAAA7D,EAAA8D,MAAA9D,EAAA+D,QACA/B,EAAAyC,KAAA1C,KANAJ,EAAA8C,KAAAZ,EAAA7D,EAAA8D,MAAA9D,EAAA+D,QACAnC,EAAA6C,KAAA9C,KANAH,EAAAiD,KAAAT,EAAAhE,EAAA8D,MAAA9D,EAAA+D,QACAzC,EAAAmD,KAAAjD,IAcAlL,SAAAmI,iBAAA,YAAAiG,MACApO,SAAAmI,iBAAA,UAAAkG,MAEAvE,EAAAwE,cAAArC,IAIA,SAAAmC,EAAA1E,QAEAI,EAAA3C,UAEAuC,EAAAsE,iBACAtE,EAAAuE,kBAEApD,IAAAd,EAAAE,QAAAH,EAAAS,SAKGM,IAAAd,EAAAG,MAAAJ,EAAAhC,OAIA+C,IAAAd,EAAAI,KAAAL,EAAA/B,OAEH2D,EAAAyC,KAAAZ,EAAA7D,EAAA8D,MAAA9D,EAAA+D,QAJAnC,EAAA6C,KAAAZ,EAAA7D,EAAA8D,MAAA9D,EAAA+D,SALAzC,EAAAmD,KAAAjD,GACAA,EAAAiD,KAAAT,EAAAhE,EAAA8D,MAAA9D,EAAA+D,UAcA,SAAAY,EAAA3E,QAEAI,EAAA3C,UAEAuC,EAAAsE,iBACAtE,EAAAuE,kBAEApD,EAAAd,EAAAC,KAEAhK,SAAA4N,oBAAA,YAAAQ,GACApO,SAAA4N,oBAAA,UAAAS,GACAvE,EAAAwE,cAAApC,IAIA,SAAAqC,EAAA7E,GAEA,QAAAI,EAAA3C,cAEA2C,EAAAhC,OAAA,CAKA,OAHA4B,EAAAsE,iBACAtE,EAAAuE,kBAEAvE,EAAA8E,WAEA,OAEAnD,EAAA7J,GAAA,KAAAkI,EAAA+E,OACA,MAEA,OAEApD,EAAA7J,GAAA,IAAAkI,EAAA+E,OACA,MAEA,QAEApD,EAAA7J,GAAA,MAAAkI,EAAA+E,OAKA3E,EAAAwE,cAAArC,GACAnC,EAAAwE,cAAApC,IAIA,SAAAwC,EAAAhF,GAEA,QAAAI,EAAA3C,QAAA,CAEA,OAAAuC,EAAAiF,QAAA5M,QAEA,OACA8I,EAAAd,EAAAK,aACAc,EAAAiD,KAAAT,EAAAhE,EAAAiF,QAAA,GAAAnB,MAAA9D,EAAAiF,QAAA,GAAAlB,QACAzC,EAAAmD,KAAAjD,GACA,MAEA,QACAL,EAAAd,EAAAM,eACA,IAAAuE,EAAAlF,EAAAiF,QAAA,GAAAnB,MAAA9D,EAAAiF,QAAA,GAAAnB,MACAqB,EAAAnF,EAAAiF,QAAA,GAAAlB,MAAA/D,EAAAiF,QAAA,GAAAlB,MACAjC,EAAAD,EAAA7K,KAAAgD,KAAAkL,IAAAC,KAEA,IAAAtN,GAAAmI,EAAAiF,QAAA,GAAAnB,MAAA9D,EAAAiF,QAAA,GAAAnB,OAAA,EACAhM,GAAAkI,EAAAiF,QAAA,GAAAlB,MAAA/D,EAAAiF,QAAA,GAAAlB,OAAA,EACAhC,EAAA0C,KAAAZ,EAAAhM,EAAAC,IACAkK,EAAAyC,KAAA1C,GAKA3B,EAAAwE,cAAArC,IAIA,SAAA6C,EAAApF,GAEA,QAAAI,EAAA3C,QAKA,OAHAuC,EAAAsE,iBACAtE,EAAAuE,kBAEAvE,EAAAiF,QAAA5M,QAEA,OACAiJ,EAAAmD,KAAAjD,GACAA,EAAAiD,KAAAT,EAAAhE,EAAAiF,QAAA,GAAAnB,MAAA9D,EAAAiF,QAAA,GAAAlB,QACA,MAEA,QACA,IAAAmB,EAAAlF,EAAAiF,QAAA,GAAAnB,MAAA9D,EAAAiF,QAAA,GAAAnB,MACAqB,EAAAnF,EAAAiF,QAAA,GAAAlB,MAAA/D,EAAAiF,QAAA,GAAAlB,MACAjC,EAAA9K,KAAAgD,KAAAkL,IAAAC,KAEA,IAAAtN,GAAAmI,EAAAiF,QAAA,GAAAnB,MAAA9D,EAAAiF,QAAA,GAAAnB,OAAA,EACAhM,GAAAkI,EAAAiF,QAAA,GAAAlB,MAAA/D,EAAAiF,QAAA,GAAAlB,OAAA,EACA/B,EAAAyC,KAAAZ,EAAAhM,EAAAC,KAOA,SAAAuN,EAAArF,GAEA,QAAAI,EAAA3C,QAAA,CAEA,OAAAuC,EAAAiF,QAAA5M,QAEA,OACA8I,EAAAd,EAAAC,KACA,MAEA,OACAa,EAAAd,EAAAK,aACAc,EAAAiD,KAAAT,EAAAhE,EAAAiF,QAAA,GAAAnB,MAAA9D,EAAAiF,QAAA,GAAAlB,QACAzC,EAAAmD,KAAAjD,GAKApB,EAAAwE,cAAApC,IAIA,SAAA8C,EAAAtF,QAEAI,EAAA3C,SAEAuC,EAAAsE,iBAtbAlM,KAAAmN,cAEAnC,EAAA,IAAAjD,EAAAjB,QACAmE,EAAA,IAAAlD,EAAAqF,WACAlC,EAAA,IAAAnD,EAAAjB,QACAqE,EAAA,IAAApD,EAAAjB,QACAsE,EAAA,IAAArD,EAAAjB,QACAuE,EAAA,IAAAtD,EAAAjB,QAGA,WAEAuE,EAAAtI,IAAAqG,EAAA3J,EAAAyJ,EAAAzJ,EAAA2J,EAAA1J,EAAAwJ,EAAAxJ,EAAA,IACAqL,EAAAM,EAAApL,WAIAgJ,EAAAoD,KAAArE,EAAAV,OAAAlG,UAAA8F,IAAAc,EAAAa,QAEAqC,EAAAmB,KAAApD,GAAA9B,YACAgE,EAAAkB,KAAArE,EAAAV,OAAA2C,IAAA9C,YACAiE,EAAAiC,aAAAlC,EAAAD,GAAA/D,YAEAgE,EAAAmC,UAAAlE,EAAA1J,EAAAwJ,EAAAxJ,GACA0L,EAAAkC,UAAAlE,EAAA3J,EAAAyJ,EAAAzJ,GAEA4L,EAAAgB,KAAAlB,EAAAxJ,IAAAyJ,IAEAJ,EAAAqC,aAAAhC,EAAApC,GAAA9B,YAEA4D,GAAA/C,EAAAnC,YACAoF,EAAAsC,iBAAAvC,EAAAD,GAEA9B,EAAAuE,gBAAAvC,GACAjD,EAAAV,OAAA2C,GAAAuD,gBAAAvC,GAEA5B,EAAAgD,KAAArB,GACA1B,EAAAyB,IAEI/C,EAAA9B,cAAAoD,IAEJA,GAAA1K,KAAAgD,KAAA,EAAAoG,EAAA7B,sBACA8C,EAAAoD,KAAArE,EAAAV,OAAAlG,UAAA8F,IAAAc,EAAAa,QACAoC,EAAAsC,iBAAAlE,EAAAC,GACAL,EAAAuE,gBAAAvC,GACAjD,EAAAV,OAAA2C,GAAAuD,gBAAAvC,IAIA/B,EAAAmD,KAAAjD,KAOApJ,KAAAyN,WAAA,WAEA,IAAAC,EAEA3E,IAAAd,EAAAM,gBAEAmF,EAAAjE,EAAAC,EACAD,EAAAC,EACAT,EAAA7E,eAAAsJ,KAMA,IAFAA,EAAA,GAAAlE,EAAA9J,EAAA6J,EAAA7J,GAAAsI,EAAAlC,YAEA4H,EAAA,GAEAzE,EAAA7E,eAAAsJ,GAIA1F,EAAA9B,aAEAqD,EAAA8C,KAAA7C,GAIAD,EAAA7J,IAAA8J,EAAA9J,EAAA6J,EAAA7J,GAAAM,KAAAmG,uBAQAnG,KAAA2N,WAEArC,EAAA,IAAAvD,EAAAoB,QACAoC,EAAA,IAAAxD,EAAAjB,QACA0E,EAAA,IAAAzD,EAAAjB,QAEA,WAEAwE,EAAAe,KAAAzC,GAAA1C,IAAAyC,GAEA2B,EAAAsC,aAEAtC,EAAAlH,eAAA6E,EAAAhJ,SAAA+H,EAAAjC,UAEAyF,EAAAa,KAAApD,GAAA4E,MAAA7F,EAAAV,OAAA2C,IAAAqD,UAAAhC,EAAA7L,GACA+L,EAAA7J,IAAA4J,EAAAc,KAAArE,EAAAV,OAAA2C,IAAAqD,UAAAhC,EAAA5L,IAEAsI,EAAAV,OAAAlG,SAAAO,IAAA6J,GACAxD,EAAAa,OAAAlH,IAAA6J,GAEAxD,EAAA9B,aAEAyD,EAAA0C,KAAAzC,GAIAD,EAAAhI,IAAA2J,EAAAwC,WAAAlE,EAAAD,GAAAvF,eAAA4D,EAAA7B,0BAUAnG,KAAA+N,eAAA,WAEA/F,EAAAhC,QAAAgC,EAAA/B,QAEAgD,EAAA2E,WAAA5F,EAAAW,YAAAX,EAAAW,cAEAX,EAAAV,OAAAlG,SAAA4M,WAAAhG,EAAAa,OAAAI,EAAAqE,UAAAtF,EAAAW,cACAY,EAAA8C,KAAA7C,IAIAP,EAAA2E,WAAA5F,EAAAU,YAAAV,EAAAU,cAEAV,EAAAV,OAAAlG,SAAA4M,WAAAhG,EAAAa,OAAAI,EAAAqE,UAAAtF,EAAAU,cACAa,EAAA8C,KAAA7C,MAQAxJ,KAAA2H,OAAA,WAEAsB,EAAA6E,WAAA9F,EAAAV,OAAAlG,SAAA4G,EAAAa,QAEAb,EAAAS,UAEAT,EAAAmF,eAIAnF,EAAAhC,QAEAgC,EAAAyF,aAIAzF,EAAA/B,OAEA+B,EAAA2F,YAIA3F,EAAAV,OAAAlG,SAAA4M,WAAAhG,EAAAa,OAAAI,GAEAjB,EAAA+F,iBAEA/F,EAAAV,OAAA2G,OAAAjG,EAAAa,QAEAC,EAAAoF,kBAAAlG,EAAAV,OAAAlG,UA1RA,OA4RA4G,EAAAwE,cAAAtC,GAEApB,EAAAuD,KAAArE,EAAAV,OAAAlG,YAMApB,KAAAmO,MAAA,WAEApF,EAAAd,EAAAC,KACAc,EAAAf,EAAAC,KAEAF,EAAAa,OAAAwD,KAAArE,EAAA6B,SACA7B,EAAAV,OAAAlG,SAAAiL,KAAArE,EAAA+B,WACA/B,EAAAV,OAAA2C,GAAAoC,KAAArE,EAAAgC,KAEAf,EAAA6E,WAAA9F,EAAAV,OAAAlG,SAAA4G,EAAAa,QAEAb,EAAAV,OAAA2G,OAAAjG,EAAAa,QAEAb,EAAAwE,cAAAtC,GAEApB,EAAAuD,KAAArE,EAAAV,OAAAlG,WAiPApB,KAAAoO,QAAA,WAEApO,KAAAyF,WAAAqG,oBAAA,cAAAoB,MACAlN,KAAAyF,WAAAqG,oBAAA,YAAAG,MACAjM,KAAAyF,WAAAqG,oBAAA,QAAAW,MAEAzM,KAAAyF,WAAAqG,oBAAA,aAAAc,MACA5M,KAAAyF,WAAAqG,oBAAA,WAAAmB,MACAjN,KAAAyF,WAAAqG,oBAAA,YAAAkB,MAEA9O,SAAA4N,oBAAA,YAAAQ,MACApO,SAAA4N,oBAAA,UAAAS,MAEAhO,OAAAuN,oBAAA,UAAAD,MACAtN,OAAAuN,oBAAA,QAAAE,OAIAhM,KAAAyF,WAAAY,iBAAA,cAAA6G,MACAlN,KAAAyF,WAAAY,iBAAA,YAAA4F,MACAjM,KAAAyF,WAAAY,iBAAA,QAAAoG,MAEAzM,KAAAyF,WAAAY,iBAAA,aAAAuG,MACA5M,KAAAyF,WAAAY,iBAAA,WAAA4G,MACAjN,KAAAyF,WAAAY,iBAAA,YAAA2G,MAEAzO,OAAA8H,iBAAA,UAAAwF,MACAtN,OAAA8H,iBAAA,QAAA2F,MAEAhM,KAAA2G,eAGA3G,KAAA2H,WAIA/B,EAAA/F,UAAAkC,OAAAsM,OAAAtG,EAAAuG,gBAAAzO,YACA0O,YAAA3I,EAEA7D,OAAAyM,OAAAzG,GAAsBnC,qECvnBtB,IAAA6I,EAAA,WAAqB,SAAAC,EAAArM,GAAmC,OAArBsM,EAAArQ,YAAA+D,EAAAsD,KAAqBtD,EAAS,SAAAuM,EAAAvM,GAAc,QAAAkI,EAAA,EAAYA,EAAAoE,EAAAtH,SAAApH,OAAoBsK,IAAAoE,EAAAtH,SAAAkD,GAAAsE,MAAAC,QAAAvE,IAAAlI,EAAA,eAAqD0M,EAAA1M,EAAI,IAAA0M,EAAA,EAAAJ,EAAAzQ,SAAAC,cAAA,OAAwCwQ,EAAAE,MAAAG,QAAA,uEAAuFL,EAAAtI,iBAAA,iBAAAhE,GAAuCA,EAAA6J,iBAAmB0C,IAAAG,EAAAJ,EAAAtH,SAAApH,aAA8B,IAAAgP,GAAAC,aAAAC,MAAAC,MAAA/R,EAAA4R,EAAA5M,EAAA,EAAAvE,EAAA4Q,EAAA,IAAAD,EAAAY,MAAA,sBAAAC,EAAAZ,EAAA,IAAAD,EAAAY,MAAA,qBAC/X,GAAAE,KAAAL,aAAAK,KAAAL,YAAAM,OAAA,IAAAlS,EAAAoR,EAAA,IAAAD,EAAAY,MAAA,qBAA+F,OAALT,EAAA,IAAYa,SAAA,GAAA9J,IAAAgJ,EAAAe,SAAAhB,EAAAiB,UAAAf,EAAAgB,MAAA,WAA0DX,GAAAC,aAAAC,MAAAC,OAA4BS,IAAA,WAAgBxN,IAAI,IAAAsM,GAAAO,aAAAC,MAAAC,MAAkD,GAAlBE,EAAA3H,OAAAgH,EAAAM,EAAA,KAAkBN,EAAAtR,EAAA,MAAAS,EAAA6J,OAAA,IAAAtF,GAAAsM,EAAAtR,GAAA,KAAAA,EAAAsR,EAAAtM,EAAA,EAAA/E,GAAA,CAAmD,IAAAiN,EAAA2E,YAAAM,OAAyBlS,EAAAqK,OAAA4C,EAAAuF,eAAA,QAAAvF,EAAAwF,gBAAA,SAA6D,OAAApB,GAAShH,OAAA,WAAmBsH,EAAAjP,KAAA6P,OAAapK,WAAAkJ,EAAAqB,QAAApB,IACpbH,EAAAY,MAAA,SAAAX,EAAAE,EAAAG,GAA4B,IAAAJ,EAAA/F,IAAAqG,EAAA,EAAA5R,EAAAuB,KAAAmC,MAAAsB,EAAAhF,EAAAkB,OAAA2G,kBAAA,GAAApH,EAAA,GAAAuE,EAAAiN,EAAA,GAAAjN,EAAA/E,EAAA,EAAA+E,EAAA4N,EAAA,EAAA5N,EAAAkI,EAAA,EAAAlI,EAAA6N,EAAA,GAAA7N,EAAA9E,EAAA,GAAA8E,EAAA8N,EAAA,GAAA9N,EAAA+N,EAAAlS,SAAAC,cAAA,UAAwJiS,EAAA7L,MAAAzG,EAAUsS,EAAA5L,OAAA8K,EAAWc,EAAAvB,MAAAG,QAAA,yBAAyC,IAAAqB,EAAAD,EAAAE,WAAA,MAA0O,OAAjND,EAAAE,KAAA,UAAAlO,EAAA,gCAAmDgO,EAAAG,aAAA,MAAqBH,EAAAI,UAAA1B,EAAcsB,EAAAK,SAAA,IAAA5S,EAAAwR,GAAoBe,EAAAI,UAAA7B,EAAcyB,EAAAM,SAAAjC,EAAApR,EAAA2S,GAAkBI,EAAAK,SAAAnG,EAAA2F,EAAA3S,EAAA4S,GAAoBE,EAAAI,UAAA1B,EAAcsB,EAAAO,YAAA,GAAiBP,EAAAK,SAAAnG,EAAA2F,EAAA3S,EAAA4S,IAA2BxK,IAAAyK,EAAAzI,OAAA,SAAA2H,EACneuB,GAAGlC,EAAA/P,KAAAkS,IAAAnC,EAAAW,GAAgBL,EAAArQ,KAAAmS,IAAA9B,EAAAK,GAAgBe,EAAAI,UAAA1B,EAAcsB,EAAAO,YAAA,EAAgBP,EAAAK,SAAA,IAAA5S,EAAAoS,GAAoBG,EAAAI,UAAA7B,EAAcyB,EAAAM,SAAAtT,EAAAiS,GAAA,IAAAZ,EAAA,KAAArR,EAAAsR,GAAA,IAAAtR,EAAA4R,GAAA,IAAA3R,EAAA2S,GAAkDI,EAAAW,UAAAZ,EAAA7F,EAAAlI,EAAA6N,EAAA3S,EAAA8E,EAAA8N,EAAA5F,EAAA2F,EAAA3S,EAAA8E,EAAA8N,GAAqCE,EAAAK,SAAAnG,EAAAhN,EAAA8E,EAAA6N,EAAA7N,EAAA8N,GAAwBE,EAAAI,UAAA1B,EAAcsB,EAAAO,YAAA,GAAiBP,EAAAK,SAAAnG,EAAAhN,EAAA8E,EAAA6N,EAAA7N,EAAAhF,GAAA,EAAAiS,EAAAuB,GAAAV,OAAsC,iBAAApT,MAAAC,QAAAyR,2ECwBvR,WAGE,IAAIwC,EAAK,IAAOrS,KAAKgD,KAAK,GAAO,GAC7BsP,GAAM,EAAMtS,KAAKgD,KAAK,IAAQ,EAE9BuP,EAAK,EAAM,EACXC,GAAMxS,KAAKgD,KAAK,GAAO,GAAO,EAC9ByP,GAAM,EAAMzS,KAAKgD,KAAK,IAAQ,GAElC,SAAS0P,EAAaC,GACpB,IAAI1S,EAEFA,EADyB,mBAAhB0S,EACAA,EAEFA,EAkXX,WACE,IAiCIhU,EAjCAiU,EAAK,EACLC,EAAK,EACLC,EAAK,EACL/C,EAAI,EAEJgD,GA4BApU,EAAI,WACD,SAASqU,GACdA,EAAOA,EAAK9S,WACZ,IAAK,IAAI3B,EAAI,EAAGA,EAAIyU,EAAK3R,OAAQ9C,IAAK,CAEpC,IAAIuR,EAAI,oBADRnR,GAAKqU,EAAK1R,WAAW/C,IAGrBuR,GADAnR,EAAImR,IAAM,EAGVnR,GADAmR,GAAKnR,KACK,EAEVA,GAAS,YADTmR,GAAKnR,GAGP,OAAmB,wBAAXA,IAAM,KAxChBiU,EAAKG,EAAK,KACVF,EAAKE,EAAK,KACVD,EAAKC,EAAK,KAEV,IAAK,IAAIxU,EAAI,EAAGA,EAAI0U,UAAU5R,OAAQ9C,KACpCqU,GAAMG,EAAKE,UAAU1U,KACZ,IACPqU,GAAM,IAERC,GAAME,EAAKE,UAAU1U,KACZ,IACPsU,GAAM,IAERC,GAAMC,EAAKE,UAAU1U,KACZ,IACPuU,GAAM,GAIV,OADAC,EAAO,KACA,WACL,IAAIrU,EAAI,QAAUkU,EAAS,uBAAJ7C,EAGvB,OAFA6C,EAAKC,EACLA,EAAKC,EACEA,EAAKpU,GAAKqR,EAAQ,EAAJrR,IA9BzB,CAjXkBiU,GAEL3S,KAAKC,OAEhBmB,KAAKmQ,EAAI2B,EAAsBjT,GAC/BmB,KAAK+R,KAAO,IAAIC,WAAW,KAC3BhS,KAAKiS,UAAY,IAAID,WAAW,KAChC,IAAK,IAAI7U,EAAI,EAAGA,EAAI,IAAKA,IACvB6C,KAAK+R,KAAK5U,GAAK6C,KAAKmQ,EAAM,IAAJhT,GACtB6C,KAAKiS,UAAU9U,GAAK6C,KAAK+R,KAAK5U,GAAK,GAmVvC,SAAS2U,EAAsBjT,GAC7B,IAAI1B,EACAgT,EAAI,IAAI6B,WAAW,KACvB,IAAK7U,EAAI,EAAGA,EAAI,IAAKA,IACnBgT,EAAEhT,GAAKA,EAET,IAAKA,EAAI,EAAGA,EAAI,IAAKA,IAAK,CACxB,IAAIW,EAAIX,KAAO0B,KAAY,IAAM1B,IAC7B+U,EAAM/B,EAAEhT,GACZgT,EAAEhT,GAAKgT,EAAErS,GACTqS,EAAErS,GAAKoU,EAET,OAAO/B,EA3VTmB,EAAazR,WACXsS,MAAO,IAAIC,cAAc,EAAG,EAAG,GAC5B,EAAG,EAAG,EACP,GAAI,EAAG,GAEN,GAAI,EAAG,EACR,EAAG,EAAG,GACL,EAAG,EAAG,EAEP,EAAG,GAAI,GACN,EAAG,GAAI,EACR,EAAG,EAAG,EAEN,GAAI,EAAG,EACP,EAAG,GAAI,EACP,GAAI,GAAI,IACVC,MAAO,IAAID,cAAc,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,EAAG,EAAG,GAAI,EAAG,EAAG,EAAG,GAAI,GAAI,EACxE,GAAI,EAAG,EAAG,EAAG,GAAI,EAAG,GAAI,EAAG,GAAI,GAAI,EAAG,EAAG,GAAI,GAAI,GAAI,EACrD,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,EAAG,EAAG,GAAI,EAAG,EAAG,EAAG,GAAI,GAAI,GAChD,EAAG,EAAG,EAAG,GAAI,EAAG,EAAG,GAAI,GAAI,EAAG,GAAI,EAAG,GAAI,EAAG,GAAI,GAAI,EACrD,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,EAAG,GAAI,EAAG,EAAG,EAAG,GAAI,EAAG,GAAI,GAChD,EAAG,EAAG,EAAG,GAAI,EAAG,EAAG,GAAI,GAAI,GAAI,EAAG,EAAG,GAAI,GAAI,EAAG,GAAI,EACrD,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,EAAG,EAAG,GAAI,EAAG,EAAG,EAAG,GAAI,GAAI,EAAG,GAChD,EAAG,EAAG,EAAG,GAAI,EAAG,GAAI,EAAG,GAAI,GAAI,EAAG,EAAG,GAAI,GAAI,GAAI,EAAG,IACvDzS,QAAS,SAAS2S,EAAKC,GACrB,IAiBIC,EAAIC,EAjBJR,EAAYjS,KAAKiS,UACjBF,EAAO/R,KAAK+R,KACZI,EAAQnS,KAAKmS,MACbO,EAAK,EACLC,EAAK,EACLC,EAAK,EAELC,GAAKP,EAAMC,GAAOtB,EAClB9T,EAAIyB,KAAK4C,MAAM8Q,EAAMO,GACrBrT,EAAIZ,KAAK4C,MAAM+Q,EAAMM,GACrBvV,GAAKH,EAAIqC,GAAK0R,EAGd4B,EAAKR,GAFAnV,EAAIG,GAGTyV,EAAKR,GAFA/S,EAAIlC,GAMTwV,EAAKC,GACPP,EAAK,EACLC,EAAK,IAGLD,EAAK,EACLC,EAAK,GAKP,IAAIO,EAAKF,EAAKN,EAAKtB,EACf+B,EAAKF,EAAKN,EAAKvB,EACfgC,EAAKJ,EAAK,EAAM,EAAM5B,EACtBiC,EAAKJ,EAAK,EAAM,EAAM7B,EAEtBkC,EAAS,IAAJjW,EACLkW,EAAS,IAAJ7T,EAEL8T,EAAK,GAAMR,EAAKA,EAAKC,EAAKA,EAC9B,GAAIO,GAAM,EAAG,CACX,IAAIC,EAAiC,EAA3BtB,EAAUmB,EAAKrB,EAAKsB,IAE9BX,GADAY,GAAMA,GACIA,GAAMnB,EAAMoB,GAAOT,EAAKX,EAAMoB,EAAM,GAAKR,GAErD,IAAIS,EAAK,GAAMR,EAAKA,EAAKC,EAAKA,EAC9B,GAAIO,GAAM,EAAG,CACX,IAAIC,EAA2C,EAArCxB,EAAUmB,EAAKZ,EAAKT,EAAKsB,EAAKZ,IAExCE,GADAa,GAAMA,GACIA,GAAMrB,EAAMsB,GAAOT,EAAKb,EAAMsB,EAAM,GAAKR,GAErD,IAAIS,EAAK,GAAMR,EAAKA,EAAKC,EAAKA,EAC9B,GAAIO,GAAM,EAAG,CACX,IAAIC,EAAyC,EAAnC1B,EAAUmB,EAAK,EAAIrB,EAAKsB,EAAK,IAEvCT,GADAc,GAAMA,GACIA,GAAMvB,EAAMwB,GAAOT,EAAKf,EAAMwB,EAAM,GAAKR,GAIrD,OAAO,IAAQT,EAAKC,EAAKC,IAG3BgB,QAAS,SAAStB,EAAKC,EAAKsB,GAC1B,IAGInB,EAAIC,EAAIC,EAAIkB,EAeZtB,EAAIC,EAAIsB,EACRC,EAAIC,EAAIC,EAnBRjC,EAAYjS,KAAKiS,UACjBF,EAAO/R,KAAK+R,KACZI,EAAQnS,KAAKmS,MAGbU,GAAKP,EAAMC,EAAMsB,IAnHhB,EAAM,GAoHP1W,EAAIyB,KAAK4C,MAAM8Q,EAAMO,GACrBrT,EAAIZ,KAAK4C,MAAM+Q,EAAMM,GACrBjE,EAAIhQ,KAAK4C,MAAMqS,EAAMhB,GACrBvV,GAAKH,EAAIqC,EAAIoP,GAAKuC,EAIlB2B,EAAKR,GAHAnV,EAAIG,GAITyV,EAAKR,GAHA/S,EAAIlC,GAIT6W,EAAKN,GAHAjF,EAAItR,GAQTwV,GAAMC,EACJA,GAAMoB,GACR3B,EAAK,EACLC,EAAK,EACLsB,EAAK,EACLC,EAAK,EACLC,EAAK,EACLC,EAAK,GAEEpB,GAAMqB,GACb3B,EAAK,EACLC,EAAK,EACLsB,EAAK,EACLC,EAAK,EACLC,EAAK,EACLC,EAAK,IAGL1B,EAAK,EACLC,EAAK,EACLsB,EAAK,EACLC,EAAK,EACLC,EAAK,EACLC,EAAK,GAIHnB,EAAKoB,GACP3B,EAAK,EACLC,EAAK,EACLsB,EAAK,EACLC,EAAK,EACLC,EAAK,EACLC,EAAK,GAEEpB,EAAKqB,GACZ3B,EAAK,EACLC,EAAK,EACLsB,EAAK,EACLC,EAAK,EACLC,EAAK,EACLC,EAAK,IAGL1B,EAAK,EACLC,EAAK,EACLsB,EAAK,EACLC,EAAK,EACLC,EAAK,EACLC,EAAK,GAOT,IAAIlB,EAAKF,EAAKN,EAAKrB,EACf8B,EAAKF,EAAKN,EAAKtB,EACfiD,EAAKD,EAAKJ,EAAK5C,EACf+B,EAAKJ,EAAKkB,EAAK,EAAM7C,EACrBgC,EAAKJ,EAAKkB,EAAK,EAAM9C,EACrBkD,EAAKF,EAAKD,EAAK,EAAM/C,EACrBmD,EAAKxB,EAAK,EAAM,GAChByB,EAAKxB,EAAK,EAAM,GAChByB,EAAKL,EAAK,EAAM,GAEhBf,EAAS,IAAJjW,EACLkW,EAAS,IAAJ7T,EACLiV,EAAS,IAAJ7F,EAEL0E,EAAK,GAAMR,EAAKA,EAAKC,EAAKA,EAAKoB,EAAKA,EACxC,GAAIb,EAAK,EAAGZ,EAAK,MACZ,CACH,IAAIa,EAA4C,EAAtCtB,EAAUmB,EAAKrB,EAAKsB,EAAKtB,EAAK0C,KAExC/B,GADAY,GAAMA,GACIA,GAAMnB,EAAMoB,GAAOT,EAAKX,EAAMoB,EAAM,GAAKR,EAAKZ,EAAMoB,EAAM,GAAKY,GAE3E,IAAIX,EAAK,GAAMR,EAAKA,EAAKC,EAAKA,EAAKmB,EAAKA,EACxC,GAAIZ,EAAK,EAAGb,EAAK,MACZ,CACH,IAAIc,EAA2D,EAArDxB,EAAUmB,EAAKZ,EAAKT,EAAKsB,EAAKZ,EAAKV,EAAK0C,EAAKV,KAEvDpB,GADAa,GAAMA,GACIA,GAAMrB,EAAMsB,GAAOT,EAAKb,EAAMsB,EAAM,GAAKR,EAAKd,EAAMsB,EAAM,GAAKW,GAE3E,IAAIV,EAAK,GAAMR,EAAKA,EAAKC,EAAKA,EAAKkB,EAAKA,EACxC,GAAIX,EAAK,EAAGd,EAAK,MACZ,CACH,IAAIe,EAA2D,EAArD1B,EAAUmB,EAAKY,EAAKjC,EAAKsB,EAAKY,EAAKlC,EAAK0C,EAAKP,KAEvDtB,GADAc,GAAMA,GACIA,GAAMvB,EAAMwB,GAAOT,EAAKf,EAAMwB,EAAM,GAAKR,EAAKhB,EAAMwB,EAAM,GAAKU,GAE3E,IAAIK,EAAK,GAAMJ,EAAKA,EAAKC,EAAKA,EAAKC,EAAKA,EACxC,GAAIE,EAAK,EAAGZ,EAAK,MACZ,CACH,IAAIa,EAAwD,EAAlD1C,EAAUmB,EAAK,EAAIrB,EAAKsB,EAAK,EAAItB,EAAK0C,EAAK,KAErDX,GADAY,GAAMA,GACIA,GAAMvC,EAAMwC,GAAOL,EAAKnC,EAAMwC,EAAM,GAAKJ,EAAKpC,EAAMwC,EAAM,GAAKH,GAI3E,OAAO,IAAQ9B,EAAKC,EAAKC,EAAKkB,IAGhCc,QAAS,SAASnV,EAAGC,EAAG4B,EAAGuT,GACzB,IAGInC,EAAIC,EAAIC,EAAIkB,EAAIgB,EAqChBtC,EAAIC,EAAIsB,EAAIgB,EACZf,EAAIC,EAAIC,EAAIc,EACZC,EAAIC,EAAIC,EAAIC,EA1CZrD,EAAO/R,KAAK+R,KACZM,EAAQrS,KAAKqS,MAIbQ,GAAKpT,EAAIC,EAAI4B,EAAIuT,GAAKzD,EACtBjU,EAAIyB,KAAK4C,MAAM/B,EAAIoT,GACnBrT,EAAIZ,KAAK4C,MAAM9B,EAAImT,GACnBjE,EAAIhQ,KAAK4C,MAAMF,EAAIuR,GACnB9D,EAAInQ,KAAK4C,MAAMqT,EAAIhC,GACnBvV,GAAKH,EAAIqC,EAAIoP,EAAIG,GAAKsC,EAKtByB,EAAKrT,GAJAtC,EAAIG,GAKTyV,EAAKrT,GAJAF,EAAIlC,GAKT6W,EAAK7S,GAJAsN,EAAItR,GAKT+X,EAAKR,GAJA9F,EAAIzR,GAUTgY,EAAQ,EACRC,EAAQ,EACRC,EAAQ,EACRC,EAAQ,EACR3C,EAAKC,EAAIuC,IACRC,IACDzC,EAAKqB,EAAImB,IACRE,IACD1C,EAAKuC,EAAIC,IACRG,IACD1C,EAAKoB,EAAIoB,IACRC,IACDzC,EAAKsC,EAAIE,IACRE,IACDtB,EAAKkB,EAAIG,IACRC,IAwBL,IAAIzC,EAAKF,GAfTN,EAAK8C,GAAS,EAAI,EAAI,GAeHjE,EACf4B,EAAKF,GAfTN,EAAK8C,GAAS,EAAI,EAAI,GAeHlE,EACf+C,EAAKD,GAfTJ,EAAKyB,GAAS,EAAI,EAAI,GAeHnE,EACfqE,EAAKL,GAfTN,EAAKU,GAAS,EAAI,EAAI,GAeHpE,EACf6B,EAAKJ,GAdTkB,EAAKsB,GAAS,EAAI,EAAI,GAcH,EAAMjE,EACrB8B,EAAKJ,GAdTkB,EAAKsB,GAAS,EAAI,EAAI,GAcH,EAAMlE,EACrBgD,EAAKF,GAdTD,EAAKsB,GAAS,EAAI,EAAI,GAcH,EAAMnE,EACrBsE,EAAKN,GAdTL,EAAKS,GAAS,EAAI,EAAI,GAcH,EAAMpE,EACrBiD,EAAKxB,GAbTmC,EAAKK,GAAS,EAAI,EAAI,GAaH,EAAMjE,EACrBkD,EAAKxB,GAbTmC,EAAKK,GAAS,EAAI,EAAI,GAaH,EAAMlE,EACrBmD,EAAKL,GAbTgB,EAAKK,GAAS,EAAI,EAAI,GAaH,EAAMnE,EACrBuE,EAAKP,GAbTD,EAAKK,GAAS,EAAI,EAAI,GAaH,EAAMpE,EACrBwE,EAAK/C,EAAK,EAAM,EAAMzB,EACtByE,EAAK/C,EAAK,EAAM,EAAM1B,EACtB0E,EAAK5B,EAAK,EAAM,EAAM9C,EACtB2E,GAAKX,EAAK,EAAM,EAAMhE,EAEtB+B,GAAS,IAAJjW,EACLkW,GAAS,IAAJ7T,EACLiV,GAAS,IAAJ7F,EACLqH,GAAS,IAAJlH,EAELuE,GAAK,GAAMR,EAAKA,EAAKC,EAAKA,EAAKoB,EAAKA,EAAKkB,EAAKA,EAClD,GAAI/B,GAAK,EAAGZ,EAAK,MACZ,CACH,IAAIa,GAAOxB,EAAKqB,GAAKrB,EAAKsB,GAAKtB,EAAK0C,GAAK1C,EAAKkE,OAAS,GAAM,EAE7DvD,GADAY,IAAMA,IACIA,IAAMjB,EAAMkB,IAAOT,EAAKT,EAAMkB,GAAM,GAAKR,EAAKV,EAAMkB,GAAM,GAAKY,EAAK9B,EAAMkB,GAAM,GAAK8B,GAEjG,IAAI7B,GAAK,GAAMR,EAAKA,EAAKC,EAAKA,EAAKmB,EAAKA,EAAKsB,EAAKA,EAClD,GAAIlC,GAAK,EAAGb,EAAK,MACZ,CACH,IAAIc,GAAO1B,EAAKqB,GAAKZ,EAAKT,EAAKsB,GAAKZ,EAAKV,EAAK0C,GAAKV,EAAKhC,EAAKkE,GAAKlB,MAAS,GAAM,EAEjFpC,GADAa,IAAMA,IACIA,IAAMnB,EAAMoB,IAAOT,EAAKX,EAAMoB,GAAM,GAAKR,EAAKZ,EAAMoB,GAAM,GAAKW,EAAK/B,EAAMoB,GAAM,GAAKiC,GAEjG,IAAIhC,GAAK,GAAMR,EAAKA,EAAKC,EAAKA,EAAKkB,EAAKA,EAAKsB,EAAKA,EAClD,GAAIjC,GAAK,EAAGd,EAAK,MACZ,CACH,IAAIe,GAAO5B,EAAKqB,GAAKY,EAAKjC,EAAKsB,GAAKY,EAAKlC,EAAK0C,GAAKP,EAAKnC,EAAKkE,GAAKjB,MAAS,GAAM,EAEjFpC,GADAc,IAAMA,IACIA,IAAMrB,EAAMsB,IAAOT,EAAKb,EAAMsB,GAAM,GAAKR,EAAKd,EAAMsB,GAAM,GAAKU,EAAKhC,EAAMsB,GAAM,GAAKgC,GAEjG,IAAIjB,GAAK,GAAMJ,EAAKA,EAAKC,EAAKA,EAAKC,EAAKA,EAAKoB,EAAKA,EAClD,GAAIlB,GAAK,EAAGZ,EAAK,MACZ,CACH,IAAIa,GAAO5C,EAAKqB,GAAK6B,EAAKlD,EAAKsB,GAAK6B,EAAKnD,EAAK0C,GAAKU,EAAKpD,EAAKkE,GAAKb,MAAS,GAAM,EAEjFtB,GADAY,IAAMA,IACIA,IAAMrC,EAAMsC,IAAOL,EAAKjC,EAAMsC,GAAM,GAAKJ,EAAKlC,EAAMsC,GAAM,GAAKH,EAAKnC,EAAMsC,GAAM,GAAKiB,GAEjG,IAAIM,GAAK,GAAML,EAAKA,EAAKC,EAAKA,EAAKC,EAAKA,EAAKC,GAAKA,GAClD,GAAIE,GAAK,EAAGpB,EAAK,MACZ,CACH,IAAIqB,GAAOpE,EAAKqB,GAAK,EAAIrB,EAAKsB,GAAK,EAAItB,EAAK0C,GAAK,EAAI1C,EAAKkE,GAAK,MAAQ,GAAM,EAE7EnB,GADAoB,IAAMA,IACIA,IAAM7D,EAAM8D,IAAON,EAAKxD,EAAM8D,GAAM,GAAKL,EAAKzD,EAAM8D,GAAM,GAAKJ,EAAK1D,EAAM8D,GAAM,GAAKH,IAGjG,OAAO,IAAQtD,EAAKC,EAAKC,EAAKkB,EAAKgB,KAkBvCxD,EAAa8E,uBAAyBtE,YA2DWuE,EAAA,WAAmB,OAAO/E,GAA1BgF,KAAAtZ,EAAAC,EAAAD,EAAAD,QAAAC,QAAAqZ,GAEbrZ,EAAQsU,aAAeA,EAKzDvU,EAAOC,QAAUsU,EA5brB","file":"main.bundle.js","sourcesContent":["exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"body {\\n        margin: 0;\\n        background-color: black;\\n      }\\n      #container {\\n        background-color: black;\\n        \\n        margin: auto;\\n        align: center;\\n      }\\n      #scoreboard {\\n        text-align: center;\\n        font-family: Segoe UI, Helvetica, Ubuntu, sans-serif;\\n        color: white;\\n      }\\n      #scores {\\n        font-size:600%; \\n        padding:0; \\n        margin:0;\\n        color: white;\\n      }\\n      #title {\\n        background-color: white;\\n        color: black;\\n      }\\n      \", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../node_modules/css-loader/index.js!./style.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!./style.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!./style.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","import '../css/style.css';\nimport setup from './game.js';\n\nif (process.env.NODE_ENV !== 'production') {\n  console.log('Looks like we are in development mode, Beppy!');\n}\n\nvar container = document.createElement('div');\ncontainer.id = 'container';\n\ndocument.body.appendChild(container);\nwindow.onload = setup();\n\n/* CLEANER LOaDing\n\n\nasync function getComponent() {\n  // async import using a Babel pre-processor and the Syntax Dynamic Import Babel Plugin\n  var container = document.createElement('div');\n  container.id = 'container';\n\n  const THREE = await import(/* webpackChunkName: \"threejs\" / 'three');\n  // dynamic importing to separate a chunk\n    \n  return container;\n}\n\ngetComponent().then(component => {\n  let element = component(); \n  // Store the element to re-render on hot changes\n  document.body.appendChild(element);\n\n  if (module.hot) {\n    module.hot.accept('./game.js', function() {\n      console.log('Accepting the updated game module!');\n      document.body.removeChild(element);\n      element = component(); \n      // Re-render the \"component\" to update the click handler\n      document.body.appendChild(element);\n    })\n  }\n})\n\n*/\n","import SimplexNoise from './vendor/simplex-noise.js';\n\n'use strict';\n\nconst mapWidth = 20,\n  mapHeight = 30;\n\n// HASHING \nString.prototype.hashCode = function() {\n  // Java like string Hash function \n  var hash = 0, i, chr, len;\n  if (this.length == 0) return hash;\n  for (i = 0, len = this.length; i < len; i++) {\n    chr   = this.charCodeAt(i);\n    hash  = ((hash << 5) - hash) + chr;\n    hash |= 0; // Convert to 32bit integer\n  }\n  return hash;\n};\n\n// SEEDING\nexport function generateMap(seed) {\n  if (!seed) {\n    seed = Math.random.toString();\n  }\n\n  const simplex = new SimplexNoise(seed.hashCode());\n  // initializing a new simplex instance\n  // do this only once as it is relatively expensive\n\n  let assignElevation = (x,y) => {\n    return simplex.noise2D(x,y); // just for now\n  }\n\n  let elevationMap = new Array(mapWidth).fill(null).map((el, i) => {\n    return new Array(mapHeight).fill(null).map((el, j) => {\n      // run each object through the constructor\n      return assignElevation(i, j);\n    })\n  });\n\n  return elevationMap;\n}\n\n\n// BIOMES\nfunction biome(altitude, temperature, moisture) {\n  return 'tbd';\n}\n\n\n","import { CylinderGeometry , Mesh, MeshLambertMaterial } from 'three';\nimport {generateMap} from './data-seed.js';\nimport {flatMaterial} from './draw-textures.js';\n\nconst tileRadius = 1, \n tileDepth = 5;\n // represents cyliner size in meters\n\nconst tileHeight = tileRadius * 2;\nconst tileWidth = Math.sqrt(3)/2 * tileHeight;\n\nexport default function populate(scene) {\n\n  // TILES\n  let tileGeometry = new CylinderGeometry( tileRadius, tileRadius, tileDepth, 6, 1 );\n  let material = new MeshLambertMaterial( { color: 0x77dd77, flatShading: true} );\n\n  tileGeometry.computeFlatVertexNormals();\n\n  // MAP\n  let tileMap = generateMap('pepe');\n\n/*\n  tileMap.forEach(function(el, i) {\n    el.forEach(function(el, j) {\n      // axial coordinates\n\n      var tile = new Mesh( tileGeometry, material );\n      tile.position.x = tileWidth * ( i + j / 2 ); \n      tile.position.z = tileHeight * 3/4 * j; \n      tile.position.y = ( -Math.floor(Math.random() * 5) * 0.2) - tileDepth/2; \n\n      tile.castShadow = true;\n      tile.receiveShadow = true;\n      scene.add( tile );\n    })\n  });\n*/\n\n  for ( var i = -Math.round(tileMap.length / 2); i < tileMap.length - Math.round(tileMap.length / 2); i++ ) {\n    for ( var j = -Math.round(tileMap[0].length / 2); j < tileMap[0].length - Math.round(tileMap[0].length / 2); j++ ) {\n      // axial coordinates\n\n      var tile = new Mesh( tileGeometry, flatMaterial() );\n      tile.position.x = tileWidth * ( i + j / 2 ); \n      tile.position.z = tileHeight * 3/4 * j; \n      tile.position.y = ( -Math.floor(Math.random() * 5) * 0.2) - tileDepth/2; \n\n      tile.castShadow = true;\n      tile.receiveShadow = true;\n      scene.add( tile );\n    }\n  }\n  \n}\n","import {MeshLambertMaterial} from 'three';\n\n\n// COLORS\nconst GREEN = 0x77dd77,\n\n  GREY = 0x888d94,\n  CONCRETE = 0xd4d7cd,\n  WHITE = 0xfaf8f8,\n  FLESH = 0xdfa487,\n  BROWN_DARK = 0x472f31,\n\n  BLACK = 0x20261e,\n  LIME = 0xabad3d,\n  BROWN = 0x41554f,\n\n  YELLOW = 0xf2be54;\n\n\n\nexport function flatMaterial() {\n  return new MeshLambertMaterial( { color: GREEN, flatShading: true} );\n}\n","import * as THREE from 'three';\r\nimport Stats from './scripts/stats.min.js';\r\nimport populate from './draw-map.js'\r\nimport './scripts/TrackballControls.js';\r\n\r\nlet camera, controls, scene, renderer, stats;\r\nlet projector, mouse = {\r\n    x: 0,\r\n    y: 0\r\n  },\r\n  INTERSECTED;\r\nconst scale = 1;\r\n\r\nexport default function setup()\r\n{\r\n  // set up all the 3D objects in the scene   \r\n  init();\r\n\r\n  // and let's get cracking!\r\n  animate();\r\n}\r\n\r\n// set up all the 3D objects in the scene   \r\nexport function init()\r\n{ \r\n  camera = new THREE.PerspectiveCamera( 30, window.innerWidth / window.innerHeight, 1, 5000 );\r\n  camera.position.set( 0, .3, 7 );\r\n\r\n  // WORLD\r\n  scene = new THREE.Scene();\r\n  scene.background = new THREE.Color( 0x000000 );\r\n\r\n  // GROUND\r\n  populate(scene);\r\n\r\n  let groundGeo = new THREE.PlaneBufferGeometry( 10000, 10000 );\r\n  let groundMat = new THREE.MeshPhongMaterial( { color: 0xffffff, specular: 0x050505 } );\r\n  groundMat.color.setHSL( 0.095, 1, 0.75 );\r\n\r\n  let ground = new THREE.Mesh( groundGeo, groundMat );\r\n  ground.rotation.x = -Math.PI/2;\r\n  ground.position.y = -5;\r\n  ground.receiveShadow = true;\r\n\r\n  scene.add( ground );\r\n\r\n  // LIGHTS\r\n  let hemiLight = new THREE.HemisphereLight( 0xffffff, 0xffffff, 0.6 );\r\n  hemiLight.color.setHSL( 0.6, 1, 0.6 );\r\n  hemiLight.groundColor.setHSL( 0.095, 1, 0.75 );\r\n  hemiLight.position.set( 0, 50, 0 );\r\n\r\n  scene.add( hemiLight );\r\n\r\n  let hemiLightHelper = new THREE.HemisphereLightHelper( hemiLight, 10 );\r\n\r\n  scene.add( hemiLightHelper );\r\n\r\n\r\n  let dirLight = new THREE.DirectionalLight( 0xffffff, 1 );\r\n  dirLight.color.setHSL( 0.1, 1, 0.95 );\r\n  dirLight.position.set( -1, 1.75, 1 );\r\n  dirLight.position.multiplyScalar( 30 );\r\n\r\n  dirLight.castShadow = true;\r\n  dirLight.shadow.mapSize.width = 2048;\r\n  dirLight.shadow.mapSize.height = 2048;\r\n\r\n  scene.add( dirLight );\r\n\r\n  let d = 10;\r\n  dirLight.shadow.camera.left = -d;\r\n  dirLight.shadow.camera.right = d;\r\n  dirLight.shadow.camera.top = d;\r\n  dirLight.shadow.camera.bottom = -d;\r\n\r\n  dirLight.shadow.camera.far = 3500;\r\n  //dirLight.shadow.bias = -0.0001;\r\n\r\n  let dirLightHelper = new THREE.DirectionalLightHelper( dirLight, 10 )\r\n\r\n  scene.add( dirLightHelper );\r\n\r\n  // RENDERER\r\n  renderer = new THREE.WebGLRenderer();\r\n  renderer.setPixelRatio( window.devicePixelRatio );\r\n  renderer.setSize( window.innerWidth, window.innerHeight );\r\n\r\n  // SHADOWS\r\n  renderer.shadowMap.enabled = true;\r\n  renderer.shadowMap.type = THREE.PCFSoftShadowMap;\r\n  // to antialias the shadow\r\n\r\n  let container = document.getElementById( 'container' );\r\n  container.appendChild( renderer.domElement );\r\n\r\n  // FPS\r\n  stats = new Stats();\r\n  container.appendChild( stats.dom );\r\n\r\n  // CONTROLS\r\n  controls = new THREE.TrackballControls( camera );\r\n\r\n  controls.rotateSpeed = 1.0;\r\n  controls.zoomSpeed = 1.2;\r\n  controls.panSpeed = 0.8;\r\n\r\n  controls.noZoom = false;\r\n  controls.noPan = false;\r\n\r\n  controls.staticMoving = true;\r\n  controls.dynamicDampingFactor = 0.3;\r\n\r\n  controls.keys = [ 65, 83, 68 ];\r\n\r\n  controls.addEventListener( 'change', render );\r\n\r\n  // resize\r\n  window.addEventListener( 'resize', onWindowResize, false );\r\n\r\n  // when the mouse moves, call the given function\r\n  document.addEventListener('mousemove', onDocumentMouseMove, false);\r\n\r\n  // draw\r\n  render();\r\n}\r\n\r\nfunction onWindowResize() {\r\n  camera.aspect = window.innerWidth / window.innerHeight;\r\n  camera.updateProjectionMatrix();\r\n  renderer.setSize( window.innerWidth, window.innerHeight );\r\n  controls.handleResize();\r\n  render();\r\n}\r\n\r\nfunction animate() {\r\n  // main loop\r\n  requestAnimationFrame( animate );\r\n  render();\r\n  update();\r\n}\r\n\r\nfunction onDocumentMouseMove(event) {\r\n  // the following line would stop any other event handler from firing\r\n  // (such as the mouse's TrackballControls)\r\n  // event.preventDefault();\r\n\r\n  // update the mouse variable\r\n  mouse.x = (event.clientX / window.innerWidth) * 2 - 1;\r\n  mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;\r\n}\r\n\r\nfunction update() {\r\n  // MOUSEOVER\r\n\r\n  var vector = new THREE.Vector3(mouse.x, mouse.y, 1);\r\n  vector.unproject(camera);\r\n  var ray = new THREE.Raycaster(camera.position, vector.sub(camera.position).normalize());\r\n  // create a Ray with origin at the mouse position\r\n  //   and direction into the scene (camera direction)\r\n\r\n  // create an array containing all objects in the scene with which the ray intersects\r\n  var intersects = ray.intersectObjects(scene.children);\r\n\r\n  // INTERSECTED = the object in the scene currently closest to the camera \r\n  //    and intersected by the Ray projected from the mouse position  \r\n\r\n  // if there is one (or more) intersections\r\n  if (intersects.length > 0) {\r\n    // if the closest object intersected is not the currently stored intersection object\r\n    if (intersects[0].object != INTERSECTED) {\r\n      // restore previous intersection object (if it exists) to its original color\r\n      if (INTERSECTED)\r\n        INTERSECTED.material.color.setHex(INTERSECTED.currentHex);\r\n      // store reference to closest object as current intersection object\r\n      INTERSECTED = intersects[0].object;\r\n      // store color of closest object (for later restoration)\r\n      INTERSECTED.currentHex = INTERSECTED.material.color.getHex();\r\n      // set a new color for closest object\r\n      INTERSECTED.material.color.setHex(0xffff00);\r\n    }\r\n  } else // there are no intersections\r\n  {\r\n    // restore previous intersection object (if it exists) to its original color\r\n    if (INTERSECTED)\r\n      INTERSECTED.material.color.setHex(INTERSECTED.currentHex);\r\n    // remove previous intersection object reference\r\n    //     by setting current intersection object to \"nothing\"\r\n    INTERSECTED = null;\r\n  }\r\n\r\n  controls.update();\r\n  stats.update();\r\n}\r\n\r\nfunction render() {\r\n  renderer.render( scene, camera );\r\n}\r\n\r\n","/**\r\n * @author Eberhard Graether / http://egraether.com/\r\n * @author Mark Lundin \t/ http://mark-lundin.com\r\n * @author Simone Manini / http://daron1337.github.io\r\n * @author Luca Antiga \t/ http://lantiga.github.io\r\n */\r\n\r\nimport * as THREE from 'three';\r\n// import Three\r\n\r\n\r\nlet TrackballControls = function ( object, domElement ) {\r\n\r\n\tvar _this = this;\r\n\tvar STATE = { NONE: - 1, ROTATE: 0, ZOOM: 1, PAN: 2, TOUCH_ROTATE: 3, TOUCH_ZOOM_PAN: 4 };\r\n\r\n\tthis.object = object;\r\n\tthis.domElement = ( domElement !== undefined ) ? domElement : document;\r\n\r\n\t// API\r\n\r\n\tthis.enabled = true;\r\n\r\n\tthis.screen = { left: 0, top: 0, width: 0, height: 0 };\r\n\r\n\tthis.rotateSpeed = 1.0;\r\n\tthis.zoomSpeed = 1.2;\r\n\tthis.panSpeed = 0.3;\r\n\r\n\tthis.noRotate = false;\r\n\tthis.noZoom = false;\r\n\tthis.noPan = false;\r\n\r\n\tthis.staticMoving = false;\r\n\tthis.dynamicDampingFactor = 0.2;\r\n\r\n\tthis.minDistance = 0;\r\n\tthis.maxDistance = Infinity;\r\n\r\n\tthis.keys = [ 65 /*A*/, 83 /*S*/, 68 /*D*/ ];\r\n\r\n\t// internals\r\n\r\n\tthis.target = new THREE.Vector3();\r\n\r\n\tvar EPS = 0.000001;\r\n\r\n\tvar lastPosition = new THREE.Vector3();\r\n\r\n\tvar _state = STATE.NONE,\r\n\t_prevState = STATE.NONE,\r\n\r\n\t_eye = new THREE.Vector3(),\r\n\r\n\t_movePrev = new THREE.Vector2(),\r\n\t_moveCurr = new THREE.Vector2(),\r\n\r\n\t_lastAxis = new THREE.Vector3(),\r\n\t_lastAngle = 0,\r\n\r\n\t_zoomStart = new THREE.Vector2(),\r\n\t_zoomEnd = new THREE.Vector2(),\r\n\r\n\t_touchZoomDistanceStart = 0,\r\n\t_touchZoomDistanceEnd = 0,\r\n\r\n\t_panStart = new THREE.Vector2(),\r\n\t_panEnd = new THREE.Vector2();\r\n\r\n\t// for reset\r\n\r\n\tthis.target0 = this.target.clone();\r\n\tthis.position0 = this.object.position.clone();\r\n\tthis.up0 = this.object.up.clone();\r\n\r\n\t// events\r\n\r\n\tvar changeEvent = { type: 'change' };\r\n\tvar startEvent = { type: 'start' };\r\n\tvar endEvent = { type: 'end' };\r\n\r\n\r\n\t// methods\r\n\r\n\tthis.handleResize = function () {\r\n\r\n\t\tif ( this.domElement === document ) {\r\n\r\n\t\t\tthis.screen.left = 0;\r\n\t\t\tthis.screen.top = 0;\r\n\t\t\tthis.screen.width = window.innerWidth;\r\n\t\t\tthis.screen.height = window.innerHeight;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar box = this.domElement.getBoundingClientRect();\r\n\t\t\t// adjustments come from similar code in the jquery offset() function\r\n\t\t\tvar d = this.domElement.ownerDocument.documentElement;\r\n\t\t\tthis.screen.left = box.left + window.pageXOffset - d.clientLeft;\r\n\t\t\tthis.screen.top = box.top + window.pageYOffset - d.clientTop;\r\n\t\t\tthis.screen.width = box.width;\r\n\t\t\tthis.screen.height = box.height;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.handleEvent = function ( event ) {\r\n\r\n\t\tif ( typeof this[ event.type ] == 'function' ) {\r\n\r\n\t\t\tthis[ event.type ]( event );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tvar getMouseOnScreen = ( function () {\r\n\r\n\t\tvar vector = new THREE.Vector2();\r\n\r\n\t\treturn function getMouseOnScreen( pageX, pageY ) {\r\n\r\n\t\t\tvector.set(\r\n\t\t\t\t( pageX - _this.screen.left ) / _this.screen.width,\r\n\t\t\t\t( pageY - _this.screen.top ) / _this.screen.height\r\n\t\t\t);\r\n\r\n\t\t\treturn vector;\r\n\r\n\t\t};\r\n\r\n\t}() );\r\n\r\n\tvar getMouseOnCircle = ( function () {\r\n\r\n\t\tvar vector = new THREE.Vector2();\r\n\r\n\t\treturn function getMouseOnCircle( pageX, pageY ) {\r\n\r\n\t\t\tvector.set(\r\n\t\t\t\t( ( pageX - _this.screen.width * 0.5 - _this.screen.left ) / ( _this.screen.width * 0.5 ) ),\r\n\t\t\t\t( ( _this.screen.height + 2 * ( _this.screen.top - pageY ) ) / _this.screen.width ) // screen.width intentional\r\n\t\t\t);\r\n\r\n\t\t\treturn vector;\r\n\r\n\t\t};\r\n\r\n\t}() );\r\n\r\n\tthis.rotateCamera = ( function() {\r\n\r\n\t\tvar axis = new THREE.Vector3(),\r\n\t\t\tquaternion = new THREE.Quaternion(),\r\n\t\t\teyeDirection = new THREE.Vector3(),\r\n\t\t\tobjectUpDirection = new THREE.Vector3(),\r\n\t\t\tobjectSidewaysDirection = new THREE.Vector3(),\r\n\t\t\tmoveDirection = new THREE.Vector3(),\r\n\t\t\tangle;\r\n\r\n\t\treturn function rotateCamera() {\r\n\r\n\t\t\tmoveDirection.set( _moveCurr.x - _movePrev.x, _moveCurr.y - _movePrev.y, 0 );\r\n\t\t\tangle = moveDirection.length();\r\n\r\n\t\t\tif ( angle ) {\r\n\r\n\t\t\t\t_eye.copy( _this.object.position ).sub( _this.target );\r\n\r\n\t\t\t\teyeDirection.copy( _eye ).normalize();\r\n\t\t\t\tobjectUpDirection.copy( _this.object.up ).normalize();\r\n\t\t\t\tobjectSidewaysDirection.crossVectors( objectUpDirection, eyeDirection ).normalize();\r\n\r\n\t\t\t\tobjectUpDirection.setLength( _moveCurr.y - _movePrev.y );\r\n\t\t\t\tobjectSidewaysDirection.setLength( _moveCurr.x - _movePrev.x );\r\n\r\n\t\t\t\tmoveDirection.copy( objectUpDirection.add( objectSidewaysDirection ) );\r\n\r\n\t\t\t\taxis.crossVectors( moveDirection, _eye ).normalize();\r\n\r\n\t\t\t\tangle *= _this.rotateSpeed;\r\n\t\t\t\tquaternion.setFromAxisAngle( axis, angle );\r\n\r\n\t\t\t\t_eye.applyQuaternion( quaternion );\r\n\t\t\t\t_this.object.up.applyQuaternion( quaternion );\r\n\r\n\t\t\t\t_lastAxis.copy( axis );\r\n\t\t\t\t_lastAngle = angle;\r\n\r\n\t\t\t} else if ( ! _this.staticMoving && _lastAngle ) {\r\n\r\n\t\t\t\t_lastAngle *= Math.sqrt( 1.0 - _this.dynamicDampingFactor );\r\n\t\t\t\t_eye.copy( _this.object.position ).sub( _this.target );\r\n\t\t\t\tquaternion.setFromAxisAngle( _lastAxis, _lastAngle );\r\n\t\t\t\t_eye.applyQuaternion( quaternion );\r\n\t\t\t\t_this.object.up.applyQuaternion( quaternion );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_movePrev.copy( _moveCurr );\r\n\r\n\t\t};\r\n\r\n\t}() );\r\n\r\n\r\n\tthis.zoomCamera = function () {\r\n\r\n\t\tvar factor;\r\n\r\n\t\tif ( _state === STATE.TOUCH_ZOOM_PAN ) {\r\n\r\n\t\t\tfactor = _touchZoomDistanceStart / _touchZoomDistanceEnd;\r\n\t\t\t_touchZoomDistanceStart = _touchZoomDistanceEnd;\r\n\t\t\t_eye.multiplyScalar( factor );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tfactor = 1.0 + ( _zoomEnd.y - _zoomStart.y ) * _this.zoomSpeed;\r\n\r\n\t\t\tif ( factor !== 1.0 && factor > 0.0 ) {\r\n\r\n\t\t\t\t_eye.multiplyScalar( factor );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( _this.staticMoving ) {\r\n\r\n\t\t\t\t_zoomStart.copy( _zoomEnd );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_zoomStart.y += ( _zoomEnd.y - _zoomStart.y ) * this.dynamicDampingFactor;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.panCamera = ( function() {\r\n\r\n\t\tvar mouseChange = new THREE.Vector2(),\r\n\t\t\tobjectUp = new THREE.Vector3(),\r\n\t\t\tpan = new THREE.Vector3();\r\n\r\n\t\treturn function panCamera() {\r\n\r\n\t\t\tmouseChange.copy( _panEnd ).sub( _panStart );\r\n\r\n\t\t\tif ( mouseChange.lengthSq() ) {\r\n\r\n\t\t\t\tmouseChange.multiplyScalar( _eye.length() * _this.panSpeed );\r\n\r\n\t\t\t\tpan.copy( _eye ).cross( _this.object.up ).setLength( mouseChange.x );\r\n\t\t\t\tpan.add( objectUp.copy( _this.object.up ).setLength( mouseChange.y ) );\r\n\r\n\t\t\t\t_this.object.position.add( pan );\r\n\t\t\t\t_this.target.add( pan );\r\n\r\n\t\t\t\tif ( _this.staticMoving ) {\r\n\r\n\t\t\t\t\t_panStart.copy( _panEnd );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t_panStart.add( mouseChange.subVectors( _panEnd, _panStart ).multiplyScalar( _this.dynamicDampingFactor ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}() );\r\n\r\n\tthis.checkDistances = function () {\r\n\r\n\t\tif ( ! _this.noZoom || ! _this.noPan ) {\r\n\r\n\t\t\tif ( _eye.lengthSq() > _this.maxDistance * _this.maxDistance ) {\r\n\r\n\t\t\t\t_this.object.position.addVectors( _this.target, _eye.setLength( _this.maxDistance ) );\r\n\t\t\t\t_zoomStart.copy( _zoomEnd );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( _eye.lengthSq() < _this.minDistance * _this.minDistance ) {\r\n\r\n\t\t\t\t_this.object.position.addVectors( _this.target, _eye.setLength( _this.minDistance ) );\r\n\t\t\t\t_zoomStart.copy( _zoomEnd );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.update = function () {\r\n\r\n\t\t_eye.subVectors( _this.object.position, _this.target );\r\n\r\n\t\tif ( ! _this.noRotate ) {\r\n\r\n\t\t\t_this.rotateCamera();\r\n\r\n\t\t}\r\n\r\n\t\tif ( ! _this.noZoom ) {\r\n\r\n\t\t\t_this.zoomCamera();\r\n\r\n\t\t}\r\n\r\n\t\tif ( ! _this.noPan ) {\r\n\r\n\t\t\t_this.panCamera();\r\n\r\n\t\t}\r\n\r\n\t\t_this.object.position.addVectors( _this.target, _eye );\r\n\r\n\t\t_this.checkDistances();\r\n\r\n\t\t_this.object.lookAt( _this.target );\r\n\r\n\t\tif ( lastPosition.distanceToSquared( _this.object.position ) > EPS ) {\r\n\r\n\t\t\t_this.dispatchEvent( changeEvent );\r\n\r\n\t\t\tlastPosition.copy( _this.object.position );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.reset = function () {\r\n\r\n\t\t_state = STATE.NONE;\r\n\t\t_prevState = STATE.NONE;\r\n\r\n\t\t_this.target.copy( _this.target0 );\r\n\t\t_this.object.position.copy( _this.position0 );\r\n\t\t_this.object.up.copy( _this.up0 );\r\n\r\n\t\t_eye.subVectors( _this.object.position, _this.target );\r\n\r\n\t\t_this.object.lookAt( _this.target );\r\n\r\n\t\t_this.dispatchEvent( changeEvent );\r\n\r\n\t\tlastPosition.copy( _this.object.position );\r\n\r\n\t};\r\n\r\n\t// listeners\r\n\r\n\tfunction keydown( event ) {\r\n\r\n\t\tif ( _this.enabled === false ) return;\r\n\r\n\t\twindow.removeEventListener( 'keydown', keydown );\r\n\r\n\t\t_prevState = _state;\r\n\r\n\t\tif ( _state !== STATE.NONE ) {\r\n\r\n\t\t\treturn;\r\n\r\n\t\t} else if ( event.keyCode === _this.keys[ STATE.ROTATE ] && ! _this.noRotate ) {\r\n\r\n\t\t\t_state = STATE.ROTATE;\r\n\r\n\t\t} else if ( event.keyCode === _this.keys[ STATE.ZOOM ] && ! _this.noZoom ) {\r\n\r\n\t\t\t_state = STATE.ZOOM;\r\n\r\n\t\t} else if ( event.keyCode === _this.keys[ STATE.PAN ] && ! _this.noPan ) {\r\n\r\n\t\t\t_state = STATE.PAN;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction keyup( event ) {\r\n\r\n\t\tif ( _this.enabled === false ) return;\r\n\r\n\t\t_state = _prevState;\r\n\r\n\t\twindow.addEventListener( 'keydown', keydown, false );\r\n\r\n\t}\r\n\r\n\tfunction mousedown( event ) {\r\n\r\n\t\tif ( _this.enabled === false ) return;\r\n\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopPropagation();\r\n\r\n\t\tif ( _state === STATE.NONE ) {\r\n\r\n\t\t\t_state = event.button;\r\n\r\n\t\t}\r\n\r\n\t\tif ( _state === STATE.ROTATE && ! _this.noRotate ) {\r\n\r\n\t\t\t_moveCurr.copy( getMouseOnCircle( event.pageX, event.pageY ) );\r\n\t\t\t_movePrev.copy( _moveCurr );\r\n\r\n\t\t} else if ( _state === STATE.ZOOM && ! _this.noZoom ) {\r\n\r\n\t\t\t_zoomStart.copy( getMouseOnScreen( event.pageX, event.pageY ) );\r\n\t\t\t_zoomEnd.copy( _zoomStart );\r\n\r\n\t\t} else if ( _state === STATE.PAN && ! _this.noPan ) {\r\n\r\n\t\t\t_panStart.copy( getMouseOnScreen( event.pageX, event.pageY ) );\r\n\t\t\t_panEnd.copy( _panStart );\r\n\r\n\t\t}\r\n\r\n\t\tdocument.addEventListener( 'mousemove', mousemove, false );\r\n\t\tdocument.addEventListener( 'mouseup', mouseup, false );\r\n\r\n\t\t_this.dispatchEvent( startEvent );\r\n\r\n\t}\r\n\r\n\tfunction mousemove( event ) {\r\n\r\n\t\tif ( _this.enabled === false ) return;\r\n\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopPropagation();\r\n\r\n\t\tif ( _state === STATE.ROTATE && ! _this.noRotate ) {\r\n\r\n\t\t\t_movePrev.copy( _moveCurr );\r\n\t\t\t_moveCurr.copy( getMouseOnCircle( event.pageX, event.pageY ) );\r\n\r\n\t\t} else if ( _state === STATE.ZOOM && ! _this.noZoom ) {\r\n\r\n\t\t\t_zoomEnd.copy( getMouseOnScreen( event.pageX, event.pageY ) );\r\n\r\n\t\t} else if ( _state === STATE.PAN && ! _this.noPan ) {\r\n\r\n\t\t\t_panEnd.copy( getMouseOnScreen( event.pageX, event.pageY ) );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction mouseup( event ) {\r\n\r\n\t\tif ( _this.enabled === false ) return;\r\n\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopPropagation();\r\n\r\n\t\t_state = STATE.NONE;\r\n\r\n\t\tdocument.removeEventListener( 'mousemove', mousemove );\r\n\t\tdocument.removeEventListener( 'mouseup', mouseup );\r\n\t\t_this.dispatchEvent( endEvent );\r\n\r\n\t}\r\n\r\n\tfunction mousewheel( event ) {\r\n\r\n\t\tif ( _this.enabled === false ) return;\r\n\t\t\r\n\t\tif ( _this.noZoom === true ) return;\r\n\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopPropagation();\r\n\r\n\t\tswitch ( event.deltaMode ) {\r\n\r\n\t\t\tcase 2:\r\n\t\t\t\t// Zoom in pages\r\n\t\t\t\t_zoomStart.y -= event.deltaY * 0.025;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 1:\r\n\t\t\t\t// Zoom in lines\r\n\t\t\t\t_zoomStart.y -= event.deltaY * 0.01;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\t// undefined, 0, assume pixels\r\n\t\t\t\t_zoomStart.y -= event.deltaY * 0.00025;\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\t_this.dispatchEvent( startEvent );\r\n\t\t_this.dispatchEvent( endEvent );\r\n\r\n\t}\r\n\r\n\tfunction touchstart( event ) {\r\n\r\n\t\tif ( _this.enabled === false ) return;\r\n\r\n\t\tswitch ( event.touches.length ) {\r\n\r\n\t\t\tcase 1:\r\n\t\t\t\t_state = STATE.TOUCH_ROTATE;\r\n\t\t\t\t_moveCurr.copy( getMouseOnCircle( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY ) );\r\n\t\t\t\t_movePrev.copy( _moveCurr );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault: // 2 or more\r\n\t\t\t\t_state = STATE.TOUCH_ZOOM_PAN;\r\n\t\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\r\n\t\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\r\n\t\t\t\t_touchZoomDistanceEnd = _touchZoomDistanceStart = Math.sqrt( dx * dx + dy * dy );\r\n\r\n\t\t\t\tvar x = ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX ) / 2;\r\n\t\t\t\tvar y = ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY ) / 2;\r\n\t\t\t\t_panStart.copy( getMouseOnScreen( x, y ) );\r\n\t\t\t\t_panEnd.copy( _panStart );\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\t_this.dispatchEvent( startEvent );\r\n\r\n\t}\r\n\r\n\tfunction touchmove( event ) {\r\n\r\n\t\tif ( _this.enabled === false ) return;\r\n\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopPropagation();\r\n\r\n\t\tswitch ( event.touches.length ) {\r\n\r\n\t\t\tcase 1:\r\n\t\t\t\t_movePrev.copy( _moveCurr );\r\n\t\t\t\t_moveCurr.copy( getMouseOnCircle( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY ) );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault: // 2 or more\r\n\t\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\r\n\t\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\r\n\t\t\t\t_touchZoomDistanceEnd = Math.sqrt( dx * dx + dy * dy );\r\n\r\n\t\t\t\tvar x = ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX ) / 2;\r\n\t\t\t\tvar y = ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY ) / 2;\r\n\t\t\t\t_panEnd.copy( getMouseOnScreen( x, y ) );\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction touchend( event ) {\r\n\r\n\t\tif ( _this.enabled === false ) return;\r\n\r\n\t\tswitch ( event.touches.length ) {\r\n\r\n\t\t\tcase 0:\r\n\t\t\t\t_state = STATE.NONE;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 1:\r\n\t\t\t\t_state = STATE.TOUCH_ROTATE;\r\n\t\t\t\t_moveCurr.copy( getMouseOnCircle( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY ) );\r\n\t\t\t\t_movePrev.copy( _moveCurr );\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\t_this.dispatchEvent( endEvent );\r\n\r\n\t}\r\n\r\n\tfunction contextmenu( event ) {\r\n\r\n\t\tif ( _this.enabled === false ) return;\r\n\r\n\t\tevent.preventDefault();\r\n\r\n\t}\r\n\r\n\tthis.dispose = function() {\r\n\r\n\t\tthis.domElement.removeEventListener( 'contextmenu', contextmenu, false );\r\n\t\tthis.domElement.removeEventListener( 'mousedown', mousedown, false );\r\n\t\tthis.domElement.removeEventListener( 'wheel', mousewheel, false );\r\n\r\n\t\tthis.domElement.removeEventListener( 'touchstart', touchstart, false );\r\n\t\tthis.domElement.removeEventListener( 'touchend', touchend, false );\r\n\t\tthis.domElement.removeEventListener( 'touchmove', touchmove, false );\r\n\r\n\t\tdocument.removeEventListener( 'mousemove', mousemove, false );\r\n\t\tdocument.removeEventListener( 'mouseup', mouseup, false );\r\n\r\n\t\twindow.removeEventListener( 'keydown', keydown, false );\r\n\t\twindow.removeEventListener( 'keyup', keyup, false );\r\n\r\n\t};\r\n\r\n\tthis.domElement.addEventListener( 'contextmenu', contextmenu, false );\r\n\tthis.domElement.addEventListener( 'mousedown', mousedown, false );\r\n\tthis.domElement.addEventListener( 'wheel', mousewheel, false );\r\n\r\n\tthis.domElement.addEventListener( 'touchstart', touchstart, false );\r\n\tthis.domElement.addEventListener( 'touchend', touchend, false );\r\n\tthis.domElement.addEventListener( 'touchmove', touchmove, false );\r\n\r\n\twindow.addEventListener( 'keydown', keydown, false );\r\n\twindow.addEventListener( 'keyup', keyup, false );\r\n\r\n\tthis.handleResize();\r\n\r\n\t// force an update at start\r\n\tthis.update();\r\n\r\n};\r\n\r\nTrackballControls.prototype = Object.create( THREE.EventDispatcher.prototype );\r\nTrackballControls.prototype.constructor = TrackballControls;\r\n\r\nObject.assign(THREE, {TrackballControls: TrackballControls});\r\n// export as Object field\r\n","// stats.js - http://github.com/mrdoob/stats.js\r\nvar Stats=function(){function h(a){c.appendChild(a.dom);return a}function k(a){for(var d=0;d<c.children.length;d++)c.children[d].style.display=d===a?\"block\":\"none\";l=a}var l=0,c=document.createElement(\"div\");c.style.cssText=\"position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000\";c.addEventListener(\"click\",function(a){a.preventDefault();k(++l%c.children.length)},!1);var g=(performance||Date).now(),e=g,a=0,r=h(new Stats.Panel(\"FPS\",\"#0ff\",\"#002\")),f=h(new Stats.Panel(\"MS\",\"#0f0\",\"#020\"));\r\nif(self.performance&&self.performance.memory)var t=h(new Stats.Panel(\"MB\",\"#f08\",\"#201\"));k(0);return{REVISION:16,dom:c,addPanel:h,showPanel:k,begin:function(){g=(performance||Date).now()},end:function(){a++;var c=(performance||Date).now();f.update(c-g,200);if(c>e+1E3&&(r.update(1E3*a/(c-e),100),e=c,a=0,t)){var d=performance.memory;t.update(d.usedJSHeapSize/1048576,d.jsHeapSizeLimit/1048576)}return c},update:function(){g=this.end()},domElement:c,setMode:k}};\r\nStats.Panel=function(h,k,l){var c=Infinity,g=0,e=Math.round,a=e(window.devicePixelRatio||1),r=80*a,f=48*a,t=3*a,u=2*a,d=3*a,m=15*a,n=74*a,p=30*a,q=document.createElement(\"canvas\");q.width=r;q.height=f;q.style.cssText=\"width:80px;height:48px\";var b=q.getContext(\"2d\");b.font=\"bold \"+9*a+\"px Helvetica,Arial,sans-serif\";b.textBaseline=\"top\";b.fillStyle=l;b.fillRect(0,0,r,f);b.fillStyle=k;b.fillText(h,t,u);b.fillRect(d,m,n,p);b.fillStyle=l;b.globalAlpha=.9;b.fillRect(d,m,n,p);return{dom:q,update:function(f,\r\nv){c=Math.min(c,f);g=Math.max(g,f);b.fillStyle=l;b.globalAlpha=1;b.fillRect(0,0,r,m);b.fillStyle=k;b.fillText(e(f)+\" \"+h+\" (\"+e(c)+\"-\"+e(g)+\")\",t,u);b.drawImage(q,d+a,m,n-a,p,d,m,n-a,p);b.fillRect(d+n-a,m,a,p);b.fillStyle=l;b.globalAlpha=.9;b.fillRect(d+n-a,m,a,e((1-f/v)*p))}}};\"object\"===typeof module&&(module.exports=Stats);\r\n","/*\n * A fast javascript implementation of simplex noise by Jonas Wagner\n\nBased on a speed-improved simplex noise algorithm for 2D, 3D and 4D in Java.\nWhich is based on example code by Stefan Gustavson (stegu@itn.liu.se).\nWith Optimisations by Peter Eastman (peastman@drizzle.stanford.edu).\nBetter rank ordering method by Stefan Gustavson in 2012.\n\n Copyright (c) 2018 Jonas Wagner\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in all\n copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n SOFTWARE.\n */\n(function() {\n  'use strict';\n\n  var F2 = 0.5 * (Math.sqrt(3.0) - 1.0);\n  var G2 = (3.0 - Math.sqrt(3.0)) / 6.0;\n  var F3 = 1.0 / 3.0;\n  var G3 = 1.0 / 6.0;\n  var F4 = (Math.sqrt(5.0) - 1.0) / 4.0;\n  var G4 = (5.0 - Math.sqrt(5.0)) / 20.0;\n\n  function SimplexNoise(randomOrSeed) {\n    var random;\n    if (typeof randomOrSeed == 'function') {\n      random = randomOrSeed;\n    }\n    else if (randomOrSeed) {\n      random = alea(randomOrSeed);\n    } else {\n      random = Math.random;\n    }\n    this.p = buildPermutationTable(random);\n    this.perm = new Uint8Array(512);\n    this.permMod12 = new Uint8Array(512);\n    for (var i = 0; i < 512; i++) {\n      this.perm[i] = this.p[i & 255];\n      this.permMod12[i] = this.perm[i] % 12;\n    }\n\n  }\n  SimplexNoise.prototype = {\n    grad3: new Float32Array([1, 1, 0,\n      -1, 1, 0,\n      1, -1, 0,\n\n      -1, -1, 0,\n      1, 0, 1,\n      -1, 0, 1,\n\n      1, 0, -1,\n      -1, 0, -1,\n      0, 1, 1,\n\n      0, -1, 1,\n      0, 1, -1,\n      0, -1, -1]),\n    grad4: new Float32Array([0, 1, 1, 1, 0, 1, 1, -1, 0, 1, -1, 1, 0, 1, -1, -1,\n      0, -1, 1, 1, 0, -1, 1, -1, 0, -1, -1, 1, 0, -1, -1, -1,\n      1, 0, 1, 1, 1, 0, 1, -1, 1, 0, -1, 1, 1, 0, -1, -1,\n      -1, 0, 1, 1, -1, 0, 1, -1, -1, 0, -1, 1, -1, 0, -1, -1,\n      1, 1, 0, 1, 1, 1, 0, -1, 1, -1, 0, 1, 1, -1, 0, -1,\n      -1, 1, 0, 1, -1, 1, 0, -1, -1, -1, 0, 1, -1, -1, 0, -1,\n      1, 1, 1, 0, 1, 1, -1, 0, 1, -1, 1, 0, 1, -1, -1, 0,\n      -1, 1, 1, 0, -1, 1, -1, 0, -1, -1, 1, 0, -1, -1, -1, 0]),\n    noise2D: function(xin, yin) {\n      var permMod12 = this.permMod12;\n      var perm = this.perm;\n      var grad3 = this.grad3;\n      var n0 = 0; // Noise contributions from the three corners\n      var n1 = 0;\n      var n2 = 0;\n      // Skew the input space to determine which simplex cell we're in\n      var s = (xin + yin) * F2; // Hairy factor for 2D\n      var i = Math.floor(xin + s);\n      var j = Math.floor(yin + s);\n      var t = (i + j) * G2;\n      var X0 = i - t; // Unskew the cell origin back to (x,y) space\n      var Y0 = j - t;\n      var x0 = xin - X0; // The x,y distances from the cell origin\n      var y0 = yin - Y0;\n      // For the 2D case, the simplex shape is an equilateral triangle.\n      // Determine which simplex we are in.\n      var i1, j1; // Offsets for second (middle) corner of simplex in (i,j) coords\n      if (x0 > y0) {\n        i1 = 1;\n        j1 = 0;\n      } // lower triangle, XY order: (0,0)->(1,0)->(1,1)\n      else {\n        i1 = 0;\n        j1 = 1;\n      } // upper triangle, YX order: (0,0)->(0,1)->(1,1)\n      // A step of (1,0) in (i,j) means a step of (1-c,-c) in (x,y), and\n      // a step of (0,1) in (i,j) means a step of (-c,1-c) in (x,y), where\n      // c = (3-sqrt(3))/6\n      var x1 = x0 - i1 + G2; // Offsets for middle corner in (x,y) unskewed coords\n      var y1 = y0 - j1 + G2;\n      var x2 = x0 - 1.0 + 2.0 * G2; // Offsets for last corner in (x,y) unskewed coords\n      var y2 = y0 - 1.0 + 2.0 * G2;\n      // Work out the hashed gradient indices of the three simplex corners\n      var ii = i & 255;\n      var jj = j & 255;\n      // Calculate the contribution from the three corners\n      var t0 = 0.5 - x0 * x0 - y0 * y0;\n      if (t0 >= 0) {\n        var gi0 = permMod12[ii + perm[jj]] * 3;\n        t0 *= t0;\n        n0 = t0 * t0 * (grad3[gi0] * x0 + grad3[gi0 + 1] * y0); // (x,y) of grad3 used for 2D gradient\n      }\n      var t1 = 0.5 - x1 * x1 - y1 * y1;\n      if (t1 >= 0) {\n        var gi1 = permMod12[ii + i1 + perm[jj + j1]] * 3;\n        t1 *= t1;\n        n1 = t1 * t1 * (grad3[gi1] * x1 + grad3[gi1 + 1] * y1);\n      }\n      var t2 = 0.5 - x2 * x2 - y2 * y2;\n      if (t2 >= 0) {\n        var gi2 = permMod12[ii + 1 + perm[jj + 1]] * 3;\n        t2 *= t2;\n        n2 = t2 * t2 * (grad3[gi2] * x2 + grad3[gi2 + 1] * y2);\n      }\n      // Add contributions from each corner to get the final noise value.\n      // The result is scaled to return values in the interval [-1,1].\n      return 70.0 * (n0 + n1 + n2);\n    },\n    // 3D simplex noise\n    noise3D: function(xin, yin, zin) {\n      var permMod12 = this.permMod12;\n      var perm = this.perm;\n      var grad3 = this.grad3;\n      var n0, n1, n2, n3; // Noise contributions from the four corners\n      // Skew the input space to determine which simplex cell we're in\n      var s = (xin + yin + zin) * F3; // Very nice and simple skew factor for 3D\n      var i = Math.floor(xin + s);\n      var j = Math.floor(yin + s);\n      var k = Math.floor(zin + s);\n      var t = (i + j + k) * G3;\n      var X0 = i - t; // Unskew the cell origin back to (x,y,z) space\n      var Y0 = j - t;\n      var Z0 = k - t;\n      var x0 = xin - X0; // The x,y,z distances from the cell origin\n      var y0 = yin - Y0;\n      var z0 = zin - Z0;\n      // For the 3D case, the simplex shape is a slightly irregular tetrahedron.\n      // Determine which simplex we are in.\n      var i1, j1, k1; // Offsets for second corner of simplex in (i,j,k) coords\n      var i2, j2, k2; // Offsets for third corner of simplex in (i,j,k) coords\n      if (x0 >= y0) {\n        if (y0 >= z0) {\n          i1 = 1;\n          j1 = 0;\n          k1 = 0;\n          i2 = 1;\n          j2 = 1;\n          k2 = 0;\n        } // X Y Z order\n        else if (x0 >= z0) {\n          i1 = 1;\n          j1 = 0;\n          k1 = 0;\n          i2 = 1;\n          j2 = 0;\n          k2 = 1;\n        } // X Z Y order\n        else {\n          i1 = 0;\n          j1 = 0;\n          k1 = 1;\n          i2 = 1;\n          j2 = 0;\n          k2 = 1;\n        } // Z X Y order\n      }\n      else { // x0<y0\n        if (y0 < z0) {\n          i1 = 0;\n          j1 = 0;\n          k1 = 1;\n          i2 = 0;\n          j2 = 1;\n          k2 = 1;\n        } // Z Y X order\n        else if (x0 < z0) {\n          i1 = 0;\n          j1 = 1;\n          k1 = 0;\n          i2 = 0;\n          j2 = 1;\n          k2 = 1;\n        } // Y Z X order\n        else {\n          i1 = 0;\n          j1 = 1;\n          k1 = 0;\n          i2 = 1;\n          j2 = 1;\n          k2 = 0;\n        } // Y X Z order\n      }\n      // A step of (1,0,0) in (i,j,k) means a step of (1-c,-c,-c) in (x,y,z),\n      // a step of (0,1,0) in (i,j,k) means a step of (-c,1-c,-c) in (x,y,z), and\n      // a step of (0,0,1) in (i,j,k) means a step of (-c,-c,1-c) in (x,y,z), where\n      // c = 1/6.\n      var x1 = x0 - i1 + G3; // Offsets for second corner in (x,y,z) coords\n      var y1 = y0 - j1 + G3;\n      var z1 = z0 - k1 + G3;\n      var x2 = x0 - i2 + 2.0 * G3; // Offsets for third corner in (x,y,z) coords\n      var y2 = y0 - j2 + 2.0 * G3;\n      var z2 = z0 - k2 + 2.0 * G3;\n      var x3 = x0 - 1.0 + 3.0 * G3; // Offsets for last corner in (x,y,z) coords\n      var y3 = y0 - 1.0 + 3.0 * G3;\n      var z3 = z0 - 1.0 + 3.0 * G3;\n      // Work out the hashed gradient indices of the four simplex corners\n      var ii = i & 255;\n      var jj = j & 255;\n      var kk = k & 255;\n      // Calculate the contribution from the four corners\n      var t0 = 0.6 - x0 * x0 - y0 * y0 - z0 * z0;\n      if (t0 < 0) n0 = 0.0;\n      else {\n        var gi0 = permMod12[ii + perm[jj + perm[kk]]] * 3;\n        t0 *= t0;\n        n0 = t0 * t0 * (grad3[gi0] * x0 + grad3[gi0 + 1] * y0 + grad3[gi0 + 2] * z0);\n      }\n      var t1 = 0.6 - x1 * x1 - y1 * y1 - z1 * z1;\n      if (t1 < 0) n1 = 0.0;\n      else {\n        var gi1 = permMod12[ii + i1 + perm[jj + j1 + perm[kk + k1]]] * 3;\n        t1 *= t1;\n        n1 = t1 * t1 * (grad3[gi1] * x1 + grad3[gi1 + 1] * y1 + grad3[gi1 + 2] * z1);\n      }\n      var t2 = 0.6 - x2 * x2 - y2 * y2 - z2 * z2;\n      if (t2 < 0) n2 = 0.0;\n      else {\n        var gi2 = permMod12[ii + i2 + perm[jj + j2 + perm[kk + k2]]] * 3;\n        t2 *= t2;\n        n2 = t2 * t2 * (grad3[gi2] * x2 + grad3[gi2 + 1] * y2 + grad3[gi2 + 2] * z2);\n      }\n      var t3 = 0.6 - x3 * x3 - y3 * y3 - z3 * z3;\n      if (t3 < 0) n3 = 0.0;\n      else {\n        var gi3 = permMod12[ii + 1 + perm[jj + 1 + perm[kk + 1]]] * 3;\n        t3 *= t3;\n        n3 = t3 * t3 * (grad3[gi3] * x3 + grad3[gi3 + 1] * y3 + grad3[gi3 + 2] * z3);\n      }\n      // Add contributions from each corner to get the final noise value.\n      // The result is scaled to stay just inside [-1,1]\n      return 32.0 * (n0 + n1 + n2 + n3);\n    },\n    // 4D simplex noise, better simplex rank ordering method 2012-03-09\n    noise4D: function(x, y, z, w) {\n      var perm = this.perm;\n      var grad4 = this.grad4;\n\n      var n0, n1, n2, n3, n4; // Noise contributions from the five corners\n      // Skew the (x,y,z,w) space to determine which cell of 24 simplices we're in\n      var s = (x + y + z + w) * F4; // Factor for 4D skewing\n      var i = Math.floor(x + s);\n      var j = Math.floor(y + s);\n      var k = Math.floor(z + s);\n      var l = Math.floor(w + s);\n      var t = (i + j + k + l) * G4; // Factor for 4D unskewing\n      var X0 = i - t; // Unskew the cell origin back to (x,y,z,w) space\n      var Y0 = j - t;\n      var Z0 = k - t;\n      var W0 = l - t;\n      var x0 = x - X0; // The x,y,z,w distances from the cell origin\n      var y0 = y - Y0;\n      var z0 = z - Z0;\n      var w0 = w - W0;\n      // For the 4D case, the simplex is a 4D shape I won't even try to describe.\n      // To find out which of the 24 possible simplices we're in, we need to\n      // determine the magnitude ordering of x0, y0, z0 and w0.\n      // Six pair-wise comparisons are performed between each possible pair\n      // of the four coordinates, and the results are used to rank the numbers.\n      var rankx = 0;\n      var ranky = 0;\n      var rankz = 0;\n      var rankw = 0;\n      if (x0 > y0) rankx++;\n      else ranky++;\n      if (x0 > z0) rankx++;\n      else rankz++;\n      if (x0 > w0) rankx++;\n      else rankw++;\n      if (y0 > z0) ranky++;\n      else rankz++;\n      if (y0 > w0) ranky++;\n      else rankw++;\n      if (z0 > w0) rankz++;\n      else rankw++;\n      var i1, j1, k1, l1; // The integer offsets for the second simplex corner\n      var i2, j2, k2, l2; // The integer offsets for the third simplex corner\n      var i3, j3, k3, l3; // The integer offsets for the fourth simplex corner\n      // simplex[c] is a 4-vector with the numbers 0, 1, 2 and 3 in some order.\n      // Many values of c will never occur, since e.g. x>y>z>w makes x<z, y<w and x<w\n      // impossible. Only the 24 indices which have non-zero entries make any sense.\n      // We use a thresholding to set the coordinates in turn from the largest magnitude.\n      // Rank 3 denotes the largest coordinate.\n      i1 = rankx >= 3 ? 1 : 0;\n      j1 = ranky >= 3 ? 1 : 0;\n      k1 = rankz >= 3 ? 1 : 0;\n      l1 = rankw >= 3 ? 1 : 0;\n      // Rank 2 denotes the second largest coordinate.\n      i2 = rankx >= 2 ? 1 : 0;\n      j2 = ranky >= 2 ? 1 : 0;\n      k2 = rankz >= 2 ? 1 : 0;\n      l2 = rankw >= 2 ? 1 : 0;\n      // Rank 1 denotes the second smallest coordinate.\n      i3 = rankx >= 1 ? 1 : 0;\n      j3 = ranky >= 1 ? 1 : 0;\n      k3 = rankz >= 1 ? 1 : 0;\n      l3 = rankw >= 1 ? 1 : 0;\n      // The fifth corner has all coordinate offsets = 1, so no need to compute that.\n      var x1 = x0 - i1 + G4; // Offsets for second corner in (x,y,z,w) coords\n      var y1 = y0 - j1 + G4;\n      var z1 = z0 - k1 + G4;\n      var w1 = w0 - l1 + G4;\n      var x2 = x0 - i2 + 2.0 * G4; // Offsets for third corner in (x,y,z,w) coords\n      var y2 = y0 - j2 + 2.0 * G4;\n      var z2 = z0 - k2 + 2.0 * G4;\n      var w2 = w0 - l2 + 2.0 * G4;\n      var x3 = x0 - i3 + 3.0 * G4; // Offsets for fourth corner in (x,y,z,w) coords\n      var y3 = y0 - j3 + 3.0 * G4;\n      var z3 = z0 - k3 + 3.0 * G4;\n      var w3 = w0 - l3 + 3.0 * G4;\n      var x4 = x0 - 1.0 + 4.0 * G4; // Offsets for last corner in (x,y,z,w) coords\n      var y4 = y0 - 1.0 + 4.0 * G4;\n      var z4 = z0 - 1.0 + 4.0 * G4;\n      var w4 = w0 - 1.0 + 4.0 * G4;\n      // Work out the hashed gradient indices of the five simplex corners\n      var ii = i & 255;\n      var jj = j & 255;\n      var kk = k & 255;\n      var ll = l & 255;\n      // Calculate the contribution from the five corners\n      var t0 = 0.6 - x0 * x0 - y0 * y0 - z0 * z0 - w0 * w0;\n      if (t0 < 0) n0 = 0.0;\n      else {\n        var gi0 = (perm[ii + perm[jj + perm[kk + perm[ll]]]] % 32) * 4;\n        t0 *= t0;\n        n0 = t0 * t0 * (grad4[gi0] * x0 + grad4[gi0 + 1] * y0 + grad4[gi0 + 2] * z0 + grad4[gi0 + 3] * w0);\n      }\n      var t1 = 0.6 - x1 * x1 - y1 * y1 - z1 * z1 - w1 * w1;\n      if (t1 < 0) n1 = 0.0;\n      else {\n        var gi1 = (perm[ii + i1 + perm[jj + j1 + perm[kk + k1 + perm[ll + l1]]]] % 32) * 4;\n        t1 *= t1;\n        n1 = t1 * t1 * (grad4[gi1] * x1 + grad4[gi1 + 1] * y1 + grad4[gi1 + 2] * z1 + grad4[gi1 + 3] * w1);\n      }\n      var t2 = 0.6 - x2 * x2 - y2 * y2 - z2 * z2 - w2 * w2;\n      if (t2 < 0) n2 = 0.0;\n      else {\n        var gi2 = (perm[ii + i2 + perm[jj + j2 + perm[kk + k2 + perm[ll + l2]]]] % 32) * 4;\n        t2 *= t2;\n        n2 = t2 * t2 * (grad4[gi2] * x2 + grad4[gi2 + 1] * y2 + grad4[gi2 + 2] * z2 + grad4[gi2 + 3] * w2);\n      }\n      var t3 = 0.6 - x3 * x3 - y3 * y3 - z3 * z3 - w3 * w3;\n      if (t3 < 0) n3 = 0.0;\n      else {\n        var gi3 = (perm[ii + i3 + perm[jj + j3 + perm[kk + k3 + perm[ll + l3]]]] % 32) * 4;\n        t3 *= t3;\n        n3 = t3 * t3 * (grad4[gi3] * x3 + grad4[gi3 + 1] * y3 + grad4[gi3 + 2] * z3 + grad4[gi3 + 3] * w3);\n      }\n      var t4 = 0.6 - x4 * x4 - y4 * y4 - z4 * z4 - w4 * w4;\n      if (t4 < 0) n4 = 0.0;\n      else {\n        var gi4 = (perm[ii + 1 + perm[jj + 1 + perm[kk + 1 + perm[ll + 1]]]] % 32) * 4;\n        t4 *= t4;\n        n4 = t4 * t4 * (grad4[gi4] * x4 + grad4[gi4 + 1] * y4 + grad4[gi4 + 2] * z4 + grad4[gi4 + 3] * w4);\n      }\n      // Sum up and scale the result to cover the range [-1,1]\n      return 27.0 * (n0 + n1 + n2 + n3 + n4);\n    }\n  };\n\n  function buildPermutationTable(random) {\n    var i;\n    var p = new Uint8Array(256);\n    for (i = 0; i < 256; i++) {\n      p[i] = i;\n    }\n    for (i = 0; i < 255; i++) {\n      var r = i + ~~(random() * (256 - i));\n      var aux = p[i];\n      p[i] = p[r];\n      p[r] = aux;\n    }\n    return p;\n  }\n  SimplexNoise._buildPermutationTable = buildPermutationTable;\n\n  /*\n  The ALEA PRNG and masher code used by simplex-noise.js\n  is based on code by Johannes Baagøe, modified by Jonas Wagner.\n  See alea.md for the full license.\n  */\n  function alea() {\n    var s0 = 0;\n    var s1 = 0;\n    var s2 = 0;\n    var c = 1;\n\n    var mash = masher();\n    s0 = mash(' ');\n    s1 = mash(' ');\n    s2 = mash(' ');\n\n    for (var i = 0; i < arguments.length; i++) {\n      s0 -= mash(arguments[i]);\n      if (s0 < 0) {\n        s0 += 1;\n      }\n      s1 -= mash(arguments[i]);\n      if (s1 < 0) {\n        s1 += 1;\n      }\n      s2 -= mash(arguments[i]);\n      if (s2 < 0) {\n        s2 += 1;\n      }\n    }\n    mash = null;\n    return function() {\n      var t = 2091639 * s0 + c * 2.3283064365386963e-10; // 2^-32\n      s0 = s1;\n      s1 = s2;\n      return s2 = t - (c = t | 0);\n    };\n  }\n  function masher() {\n    var n = 0xefc8249d;\n    return function(data) {\n      data = data.toString();\n      for (var i = 0; i < data.length; i++) {\n        n += data.charCodeAt(i);\n        var h = 0.02519603282416938 * n;\n        n = h >>> 0;\n        h -= n;\n        h *= n;\n        n = h >>> 0;\n        h -= n;\n        n += h * 0x100000000; // 2^32\n      }\n      return (n >>> 0) * 2.3283064365386963e-10; // 2^-32\n    };\n  }\n\n  // amd\n  if (typeof define !== 'undefined' && define.amd) define(function() {return SimplexNoise;});\n  // common js\n  if (typeof exports !== 'undefined') exports.SimplexNoise = SimplexNoise;\n  // browser\n  else if (typeof window !== 'undefined') window.SimplexNoise = SimplexNoise;\n  // nodejs\n  if (typeof module !== 'undefined') {\n    module.exports = SimplexNoise;\n  }\n\n})();\n"],"sourceRoot":""}